

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Period of a Pendulum &#8212; PHYS 4480-7680 Computational Physics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Period of a pendulum';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lab – Period of a Pendulum" href="blankLAB%20Period%20of%20a%20Pendulum.html" />
    <link rel="prev" title="Installing Julia" href="Install.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="PHYS 4480-7680 Computational Physics - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="PHYS 4480-7680 Computational Physics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Physics 4480 / 7680 / Astronomy 7690
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Notebook%20Workflow.html">Notebook Workflow</a></li>

<li class="toctree-l1"><a class="reference internal" href="Logistics.html">Logistics</a></li>

<li class="toctree-l1"><a class="reference internal" href="Install.html">Installing Julia</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quadratures -- Period of a Pendulum</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Period of a Pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Period%20of%20a%20Pendulum.html">Lab – Period of a Pendulum</a></li>




<li class="toctree-l1"><a class="reference internal" href="Integration%20Followup.html">Integration Follow-up</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Solving Ordinary Differential Equations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Pendulum%20dynamics.html">Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Projectile%20Motion.html">LAB – Projectile Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="Automatic%20Differentiation.html">Automatic Differentiation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Classical Mechanics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Symplectic%20Integrators.html">Symmetry Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Chaos.html">LAB – Chaos</a></li>
<li class="toctree-l1"><a class="reference internal" href="Duffing%20Oscillator%20Followup.html">Followup on Duffing Oscillator</a></li>
<li class="toctree-l1"><a class="reference internal" href="Animating%20a%20Pendulum.html">Interactive Animation of Pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Animating%20the%20Duffing%20Oscillator.html">Lab – Animating the Duffing Oscillator</a></li>
<li class="toctree-l1"><a class="reference internal" href="More%20Duffing.html">Exploring Chaos with our Duffing Simulator</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Dynamical Systems without differential equations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Billiards.html">Billiards</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Interacting%20Hard%20Spheres.html">LAB – Interacting Hard Spheres</a></li>
<li class="toctree-l1"><a class="reference internal" href="ktheory.html">Kinetic Theory of Gases</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Stochastic Methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Stochastic Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="monte%20carlo%20integration.html">Stochastic approaches to integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metropolis%20Ising%20Model.html">2D Ising Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Correlation%20Times.html">Correlation times</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cluster%20Algorithms.html">Cluster Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Wolff.html">Lab – Wolff Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="Phases%20and%20Phase%20Transitions.html">Phases and Phase Transitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Binder.html">Binder Cumulants and the Scaling Hypothesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Renormalization.html">The Renormalization group</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Period of a pendulum.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Period of a Pendulum</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adimensionalizing">Adimensionalizing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strategies">Strategies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-approaches-to-numerical-quadratures">Simple approaches to numerical quadratures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-implementation-of-trapezoid-rule">Naive implementation of trapezoid rule</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-n">Choosing <code class="docutils literal notranslate"><span class="pre">n</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theory-tools">Theory tools</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#big-o-notation">Big O Notation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#richardson-extrapolation">Richardson Extrapolation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#euler-maclaurin-summation-formula">Euler-Maclaurin Summation formula</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#improving-our-trapezoid-rule-integrator">Improving our trapezoid rule integrator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fixing-the-most-obvious-inefficiency">Fixing the most obvious inefficiency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-step-size">Dynamic step size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization">Optimization</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="period-of-a-pendulum">
<h1>Period of a Pendulum<a class="headerlink" href="#period-of-a-pendulum" title="Permalink to this heading">#</a></h1>
<p>We begin our exploration of <em>computational physics</em> with an example from mechanics.  We will consider the motion of a pendulum.</p>
<p>Imagine a pendulum of length <span class="math notranslate nohighlight">\(L\)</span> is pulled up to make an angle <span class="math notranslate nohighlight">\(\theta\)</span> with respect the the vertical.</p>
<img src="https://docs.google.com/drawings/d/e/2PACX-1vTwUJDECXEo0ZeyJ-i5zonaMAytMBHm8IfrIwfRnYMoiTKyvSUGirVm9lXpy63JJHaUsopfbYRRZ74J/pub?w=877&amp;h=718"><p>The component of the graviational force which is in the direction of motion is <span class="math notranslate nohighlight">\(F_\parallel=-m g \sin(\theta)\)</span>.  The speed of the bob is <span class="math notranslate nohighlight">\(v=L d\theta/dt\)</span>.  Thus we get equations of motion</p>
<div class="amsmath math notranslate nohighlight" id="equation-504f02cb-078a-4d7a-8c3e-395b67410bf1">
<span class="eqno">()<a class="headerlink" href="#equation-504f02cb-078a-4d7a-8c3e-395b67410bf1" title="Permalink to this equation">#</a></span>\[\begin{align}
\frac{d \theta}{dt}&amp;= \frac{v}{L} \\
m \frac{d v}{dt}&amp;=-m g \sin(\theta)
\end{align}\]</div>
<p>We know the pendulum will swing back and forth.  We want to calculate its period.</p>
<p>The classic approach is to use energy arguments.  The kinetic energy of the pendulum is</p>
<div class="amsmath math notranslate nohighlight" id="equation-1a002c83-5d0f-4f11-a389-8c3ded34933a">
<span class="eqno">()<a class="headerlink" href="#equation-1a002c83-5d0f-4f11-a389-8c3ded34933a" title="Permalink to this equation">#</a></span>\[\begin{equation}
T=\frac{1}{2}m v^2.
\end{equation}\]</div>
<p>The potential energy is</p>
<div class="amsmath math notranslate nohighlight" id="equation-b1a2b6ce-be36-4cb7-8cdf-84940d02fe9e">
<span class="eqno">()<a class="headerlink" href="#equation-b1a2b6ce-be36-4cb7-8cdf-84940d02fe9e" title="Permalink to this equation">#</a></span>\[\begin{equation}
U=-mgL \cos(\theta).
\end{equation}\]</div>
<p>Then the total energy is</p>
<div class="amsmath math notranslate nohighlight" id="equation-8d2e9870-261f-489c-be20-0906d09686c4">
<span class="eqno">()<a class="headerlink" href="#equation-8d2e9870-261f-489c-be20-0906d09686c4" title="Permalink to this equation">#</a></span>\[\begin{equation}
E=\frac{1}{2}m v^2-mgL \cos(\theta).
\end{equation}\]</div>
<p>Since the total energy is conserved we can solve this for the velocity:</p>
<div class="amsmath math notranslate nohighlight" id="equation-81420a25-8c1f-4197-a254-3b170543c478">
<span class="eqno">()<a class="headerlink" href="#equation-81420a25-8c1f-4197-a254-3b170543c478" title="Permalink to this equation">#</a></span>\[\begin{equation}
v = \sqrt{\frac{2 E}{m} +2 gL \cos(\theta)}
\end{equation}\]</div>
<p>Our argument is slightly simpler if we note that the energy can be related to the maximum angle that the pendulum reaches, <span class="math notranslate nohighlight">\(\theta_m\)</span>, so:</p>
<div class="amsmath math notranslate nohighlight" id="equation-8d342641-ba50-4d43-b58b-f842607d01cf">
<span class="eqno">()<a class="headerlink" href="#equation-8d342641-ba50-4d43-b58b-f842607d01cf" title="Permalink to this equation">#</a></span>\[\begin{equation}
v = \sqrt{2 g L}\sqrt{\cos(\theta)-\cos(\theta_m)}
\end{equation}\]</div>
<p>Next we note that <span class="math notranslate nohighlight">\(v=Ld\theta/dt\)</span> and hence</p>
<div class="amsmath math notranslate nohighlight" id="equation-2df68628-23fa-463f-a008-abec0753ac04">
<span class="eqno">()<a class="headerlink" href="#equation-2df68628-23fa-463f-a008-abec0753ac04" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{d\theta}{dt}=
\sqrt{\frac{2g}{L}}
\sqrt{\cos(\theta)-\cos(\theta_m})
\end{equation}\]</div>
<p>We then note that a quarter period is the time it takes for the pendulum to rise from <span class="math notranslate nohighlight">\(\theta=0\)</span> to <span class="math notranslate nohighlight">\(\theta=\theta_m\)</span>, and hence</p>
<div class="amsmath math notranslate nohighlight" id="equation-db12da16-1ef4-45eb-a194-2c71f2734026">
<span class="eqno">()<a class="headerlink" href="#equation-db12da16-1ef4-45eb-a194-2c71f2734026" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{T}{4}=\int_{t_0}^{t_m}\!dt=\sqrt{\frac{L}{2g}}\int_0^{\theta_m}\frac{d\theta}{\sqrt{\cos(\theta)-\cos(\theta_m)}}
\end{equation}\]</div>
<p>This integral is an <em>elliptic integral</em>.  It has no closed form in terms of more elementary functions.  Thus we need to develop numerical methods to evaluate it.</p>
<p>The task of evaluating integrals is known as <em>quadratures</em>.</p>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div><section id="adimensionalizing">
<h2>Adimensionalizing<a class="headerlink" href="#adimensionalizing" title="Permalink to this heading">#</a></h2>
<p>A good first step in any numerical calculation is to <em>adimensionalize</em> your equations.  This is actually a good step in analytic work as well.</p>
<p>We will learn how to systematically do this, but here I know that for small amplitudes the period of a pendulum is</p>
<div class="amsmath math notranslate nohighlight" id="equation-be7afda4-0197-4dbe-81ed-ca457d6d68ae">
<span class="eqno">()<a class="headerlink" href="#equation-be7afda4-0197-4dbe-81ed-ca457d6d68ae" title="Permalink to this equation">#</a></span>\[\begin{equation}
T_{0}=2\pi \sqrt{\frac{L}{g}}.
\end{equation}\]</div>
<p>This it makes sense for us to calculate</p>
<div class="amsmath math notranslate nohighlight" id="equation-50bd1c08-e013-4ab7-be21-48bcbe3273be">
<span class="eqno">()<a class="headerlink" href="#equation-50bd1c08-e013-4ab7-be21-48bcbe3273be" title="Permalink to this equation">#</a></span>\[\begin{equation}
\bar T =\frac{T}{T_0}=\frac{\sqrt{2}}{\pi}\int_0^{\theta_m}\frac{d\theta}{\sqrt{\cos(\theta)-\cos(\theta_m)}}
\end{equation}\]</div>
<p>The angle <span class="math notranslate nohighlight">\(\theta_m\)</span> is already dimensionless, so we can leave it as-is.</p>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div></section>
<section id="strategies">
<h2>Strategies<a class="headerlink" href="#strategies" title="Permalink to this heading">#</a></h2>
<p>We have several strategies we could pursue now:</p>
<ol class="arabic simple">
<li><p>Type into google “Numerical Integration in Julia”.  Download the right package and do the integral.</p></li>
<li><p>Write our own integrator.</p></li>
</ol>
<p>Both are useful.  The advantage of the package is that it will probably get us results sooner.  The advantage of writing our own is that we can tweak it to meet our needs.  Also, we will learn a lot from writing the integrator.</p>
<p>We are going to try to walk the line here – both giving you the skills to work with low-level algorithms – and the ability to take advantage of high level packages.</p>
<p>It is also worth noting that there is work involved with learning how to use a package.  Generally it will be less work than writing your own routines – but that outlay should not be discounted.</p>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div></section>
<section id="simple-approaches-to-numerical-quadratures">
<h2>Simple approaches to numerical quadratures<a class="headerlink" href="#simple-approaches-to-numerical-quadratures" title="Permalink to this heading">#</a></h2>
<p>Reading: <a href="http://numerical.recipes/book.html">Chapter 4 of Numerical Recipies</a></p>
<p>The basic idea with most quadrature approaches is to break the integral into discrete segments, and then approximate the integral on each of those segments.  One straightforward approach is the “trapezoid rule” where one breaks each segment into trapezoids:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Plots</span><span class="p">,</span><span class="n">LaTeXStrings</span><span class="w"> </span><span class="c">#load in visualization software</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    showtrapezoids(f,range=(0,1),n=5;opts...)</span>

<span class="s">Illustrates trapezoid rule by plotting the function `f` over the range specified by `range`.</span>
<span class="s">Show `n` trapezoids overlayed.  Passes on options `opts` to the plot command.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">showtrapezoids</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span><span class="n">opts</span><span class="o">...</span><span class="p">)</span>
<span class="w">    </span><span class="c"># define variables</span>
<span class="w">    </span><span class="n">xmin</span><span class="o">=</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">    </span><span class="n">xmax</span><span class="o">=</span><span class="n">range</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="w">    </span><span class="c"># Create basic plot of function</span>
<span class="w">    </span><span class="n">plt</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;f&quot;</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">opts</span><span class="o">...</span><span class="p">)</span>
<span class="w">    </span><span class="c">#</span>
<span class="w">    </span><span class="c"># Draw trapezoids</span>
<span class="w">    </span><span class="c">#</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">trapezoid</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">        </span><span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="w">        </span><span class="n">x1</span><span class="o">=</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">width</span>
<span class="w">        </span><span class="n">x2</span><span class="o">=</span><span class="n">j</span><span class="o">*</span><span class="n">width</span>
<span class="w">        </span><span class="n">y1</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="w">        </span><span class="n">y2</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="w">        </span><span class="n">Shape</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="n">plot!</span><span class="p">(</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">plt</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>showtrapezoids
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span>
<span class="n">showtrapezoids</span><span class="p">(</span><span class="n">f</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="nb">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="data:image/png;base64,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DaWUECKRSJqvS7DZbAzDdPYMLkEu6OkTc+bMmTFjxltvvTVixIjnnnvO9eCqVasWLlzour1p06bg4OC1a9fOnz9/woQJTqfTfZMdhDZu3DhkyJC1a9fefvvtEydO5DiOUrp//36lUukaMH78+JCQkD/+4vPPP3frfAebRx55ZNy4cW+//fbkyZOXLFnienD9+vVtr45bt24drhrtdf/4xz/CwsLWrVs3d+7cyZMn8zxPKd21a5eXl5drQEFBQUBAwJNPPrl27drAwMDNmze7db6DzX//+1+DwfD6668vXbo0MjLSZDJRSq9cuUIIcbXw3//+t16vf/nll//xj39ER0c//PDDnWxtAL/7hM1m+/TTT3Nzc+Pj412XLxJCjh8/3tTUdNNNN7nu7tu378CBAwEBAcuWLfP09HTfZAenH3/88eDBgwEBAcuXL3ddl1RaWrpnz57ly5cTQv797383NTU1Dx4xYsTUqVPdNtdBh1K6ZcuWM2fOjBgx4ve//71UKiWEXLp0KTMz8/bbb2850nVodPbs2W6a6aC1e/fuw4cPBwcHL1u2zHXhWHFxcXJy8j333OMaUFRU9PnnnzudzlmzZl1//fVunewg9NNPP+3cuVOn0y1btsx1UWhDQ8PWrVvvuece12sXpKWl7dmzx2azxcfHz549u5PXVBnAIQQAAOi5gXqOEAAAoFcghAAAIGoIIQAAiBpCCAAAooYQAgCAqCGEAAAgagghAACIGkIIAACihhACAICoIYQAACBqCCHAwJOZmRkUFNTyLe527Njh7e398ccfu3FWAAMUXmsUYEDatGnTn/70p2+++eaOO+4oLi4eP378pEmTvv/++05eWRgA2oUQAgxUS5Ys2blz58mTJ++9996CgoL09HSDweDuSQEMPAghwEBlNBrj4uIqKystFsuhQ4cmT57s7hkBDEg4RwgwUGm12qVLlxqNxltvvRUVBOg2rAgBBqoLFy7Ex8cPHTr0woUL33///dy5c909I4ABCSEEGJCampri4+MlEsnx48eXLFly8ODB9PT0sLAwd88LYOBBCAEGpHvvvXfr1q2pqanDhw+vr68fP358QEDA4cOHZTKZu6cGMMDgHCHAwLNly5aPP/5448aNw4cPJ4TodLotW7akpaW9+OKL7p4awMCDFSEAAIgaVoQAACBqCCEAAIgaQggAAKKGEAIAgKghhAAAIGoIIQAAiBpCCAAAovb/kavt36bYHGAAAAAASUVORK5CYII=" /></div></div>
</div>
<section id="naive-implementation-of-trapezoid-rule">
<h3>Naive implementation of trapezoid rule<a class="headerlink" href="#naive-implementation-of-trapezoid-rule" title="Permalink to this heading">#</a></h3>
<p>Lets not worry about efficiency, and write the simplest implementation of the trapezoid rule that we can think of.  We will make this more efficient later – but this version is already fast enough for our purposes.  One of the points of using Julia is that the naive implementation of algorithms tends to be fast.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    naive_trap(f,range,n)</span>

<span class="s">is a naive implementation of the trapezoid rule for calculating</span>
<span class="s">`∫f(x)dx`, with `x` running between `a` and `b` where `range=(a,b)`.</span>
<span class="s">The integral region is divided into `n` trapezoids.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">    </span><span class="n">xmin</span><span class="o">=</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">    </span><span class="n">xmax</span><span class="o">=</span><span class="n">range</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="w">    </span><span class="n">dx</span><span class="o">=</span><span class="p">(</span><span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="n">x1</span><span class="o">=</span><span class="n">xmin</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
<span class="w">        </span><span class="n">x2</span><span class="o">=</span><span class="n">x1</span><span class="o">+</span><span class="n">dx</span>
<span class="w">        </span><span class="n">result</span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>naive_trap
</pre></div>
</div>
</div>
</div>
<p>At the beginning of the function I supplied a “docstring”.  This allows one to use the interactive help feature to learn about the function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">naive_trap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>search: <span class=" -Color -Color-Bold">naive_trap</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">range</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>is a naive implementation of the trapezoid rule for calculating <code class="docutils literal notranslate"><span class="pre">∫f(x)dx</span></code>, with <code class="docutils literal notranslate"><span class="pre">x</span></code> running between <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> where <code class="docutils literal notranslate"><span class="pre">range=(a,b)</span></code>. The integral region is divided into <code class="docutils literal notranslate"><span class="pre">n</span></code> trapezoids.</p>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">testf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">x</span>
<span class="n">naive_trap</span><span class="p">(</span><span class="n">testf</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.4999999999999999
</pre></div>
</div>
</div>
</div>
<p>Notationally that is fine – but for things like this it is nice to be able to pass around “pure functions” or “lambda functions” or “anonymous functions”</p>
<p>naive_trap(x-&gt;x^3,(0,1),10)</p>
<p>In that expression, <code class="docutils literal notranslate"><span class="pre">x-&gt;x^3</span></code> is short-hand for creating the function like <code class="docutils literal notranslate"><span class="pre">testf</span></code>, and then inserting it into the function call.  Here are a couple more examples of using this notation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="n">g</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7
</pre></div>
</div>
</div>
</div>
<p>Julia also has a slightly obtuse notation that we can use here, namely a <code class="docutils literal notranslate"><span class="pre">do</span></code> block: where the function is placed on the next line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">naive_trap</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3350000000000001
</pre></div>
</div>
</div>
</div>
<p>That block was equivalent to writing</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="k">end</span>

<span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3350000000000001
</pre></div>
</div>
</div>
</div>
<p>I am a bit ambivalent about the <code class="docutils literal notranslate"><span class="pre">do</span></code> block notation.  I think it is solving a problem which doesn’t exist – and it leads to hard to read code.  Nonethless, it is valid syntax, so is probably good to know.  Functions which do file IO often use that notation, as does some of the asynchronous programming stuff that we will work with later.</p>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div><p>Now, one thing I hate is remembering exactly the notation for a function definition.  A nice trick in Julia is to give multiple versions of the function that will work for any natural notation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># alternate signature</span>
<span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="p">,(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">),</span><span class="n">n</span><span class="p">)</span><span class="w"> </span>
<span class="c">#keyword arguments</span>
<span class="n">naive_trap</span><span class="p">(;</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="p">;</span><span class="n">range</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">=</span><span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>naive_trap (generic function with 4 methods)
</pre></div>
</div>
</div>
</div>
<p>Here are now all the different ways we can call our function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># the original way </span>
<span class="c">#-- matches `naive_trap(f,range,n)`</span>
<span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.75
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># matches `naive_trap(f,a,b,n)`</span>
<span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.75
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># uses keyword arguments</span>
<span class="n">naive_trap</span><span class="p">(;</span><span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="n">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.75
</pre></div>
</div>
</div>
</div>
<p>Note, the semicolon is actually optional, and it is happy with</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="n">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.75
</pre></div>
</div>
</div>
</div>
<p>Order doesn’t matter for named arguments</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">naive_trap</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="n">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.75
</pre></div>
</div>
</div>
</div>
<p>We can also package up the arguments into a container.  This is useful if we are going to be using the same arguments in multiple places in our code.  There will be fewer errors if we move them as a package</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">dictargs</span><span class="o">=</span><span class="kt">Dict</span><span class="p">(</span><span class="ss">:f</span><span class="o">=&gt;</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="ss">:range</span><span class="o">=&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="ss">:n</span><span class="o">=&gt;</span><span class="mi">4</span><span class="p">)</span>
<span class="n">naive_trap</span><span class="p">(;</span><span class="n">dictargs</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.75
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">ntupleargs</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="ss">:range</span><span class="o">=&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">naive_trap</span><span class="p">(;</span><span class="n">ntupleargs</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.75
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
<span class="n">naive_trap</span><span class="p">(</span><span class="n">args</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.75
</pre></div>
</div>
</div>
</div>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div><section id="choosing-n">
<h4>Choosing <code class="docutils literal notranslate"><span class="pre">n</span></code><a class="headerlink" href="#choosing-n" title="Permalink to this heading">#</a></h4>
<p>How big of <code class="docutils literal notranslate"><span class="pre">n</span></code> should we use?  Lets see how our result depends on <code class="docutils literal notranslate"><span class="pre">n</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">nvals</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="mi">50</span>
<span class="n">tvals</span><span class="o">=</span><span class="p">[</span><span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">nvals</span><span class="p">]</span>
<span class="n">plot</span><span class="p">(</span><span class="n">nvals</span><span class="p">,</span><span class="n">tvals</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\int_0^1x^3dx$&quot;</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">(</span><span class="n">nvals</span><span class="p">,</span><span class="n">tvals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="data:image/png;base64,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" /></div></div>
</div>
<p>We see that this converges pretty quickly. One trick to understand this is to rescale one of the axes.  Lets try plotting the difference beteen the exact result and this approximation, as a function of <span class="math notranslate nohighlight">\(1/n\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">./</span><span class="n">nvals</span><span class="p">,</span><span class="n">tvals</span><span class="o">.-</span><span class="mf">0.25</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;1/n&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\int_0^1x^3dx$-0.25&quot;</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">./</span><span class="n">nvals</span><span class="p">,</span><span class="n">tvals</span><span class="o">.-</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="data:image/png;base64,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" /></div></div>
</div>
<p>The notation <code class="docutils literal notranslate"><span class="pre">tvals.-0.25</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">./nvals</span></code> means to apply the operation elementwise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 2, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">.-</span><span class="mf">0.25</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.75, 1.75, 2.75)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">-</span><span class="mf">0.25</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="ne">MethodError</span>: no method matching -(::Tuple{Int64, Int64, Int64}, ::Float64)

<span class="n">Closest</span> <span class="n">candidates</span> <span class="n">are</span><span class="p">:</span>
  <span class="o">-</span><span class="p">(::</span><span class="n">Missing</span><span class="p">,</span> <span class="p">::</span><span class="n">Number</span><span class="p">)</span>
   <span class="o">@</span> <span class="n">Base</span> <span class="n">missing</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">123</span>
  <span class="o">-</span><span class="p">(::</span><span class="n">BigFloat</span><span class="p">,</span> <span class="p">::</span><span class="n">Union</span><span class="p">{</span><span class="n">Float16</span><span class="p">,</span> <span class="n">Float32</span><span class="p">,</span> <span class="n">Float64</span><span class="p">})</span>
   <span class="o">@</span> <span class="n">Base</span> <span class="n">mpfr</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">506</span>
  <span class="o">-</span><span class="p">(::</span><span class="n">Complex</span><span class="p">{</span><span class="n">Bool</span><span class="p">},</span> <span class="p">::</span><span class="n">Real</span><span class="p">)</span>
   <span class="o">@</span> <span class="n">Base</span> <span class="nb">complex</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">326</span>
  <span class="o">...</span>


<span class="ne">Stacktrace</span>:
 <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">top</span><span class="o">-</span><span class="n">level</span> <span class="n">scope</span>
   <span class="o">@</span> <span class="n">In</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Aside over – Lets now look at that plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">./</span><span class="n">nvals</span><span class="p">,</span><span class="n">tvals</span><span class="o">.-</span><span class="mf">0.25</span><span class="p">,</span>
<span class="w">    </span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;1/n&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\int_0^1x^3dx$-0.25&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">legend</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">./</span><span class="n">nvals</span><span class="p">,</span><span class="n">tvals</span><span class="o">.-</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It kind of looks like a parabola.  Lets plot against <code class="docutils literal notranslate"><span class="pre">1/n^2</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">./</span><span class="n">nvals</span><span class="o">.^</span><span class="mi">2</span><span class="p">,</span><span class="n">tvals</span><span class="o">.-</span><span class="mf">0.25</span><span class="p">,</span>
<span class="w">    </span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;1/n²&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\int_0^1x^3dx$-0.25&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">legend</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">./</span><span class="n">nvals</span><span class="o">.^</span><span class="mi">2</span><span class="p">,</span><span class="n">tvals</span><span class="o">.-</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Apparently the error scales as <span class="math notranslate nohighlight">\(1/n^2\)</span></p>
<p>An even better approach is to use a log-log plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">scatter</span><span class="p">(</span><span class="n">nvals</span><span class="p">,</span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">tvals</span><span class="o">.-</span><span class="mf">0.25</span><span class="p">)),</span>
<span class="w">    </span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\int_0^1x^3dx$-0.25&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">legend</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">xaxis</span><span class="o">=</span><span class="ss">:log</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">yaxis</span><span class="o">=</span><span class="ss">:log</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If a plot of <span class="math notranslate nohighlight">\(\log(y)\)</span>  vs <span class="math notranslate nohighlight">\(\log(x)\)</span> is a a straight line:  <span class="math notranslate nohighlight">\(\log(y)=a+b \log(x)\)</span>, then <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span> are related by a power law:  <span class="math notranslate nohighlight">\(y=\alpha x^\beta\)</span>, where <span class="math notranslate nohighlight">\(\alpha=\exp(a)\)</span> and <span class="math notranslate nohighlight">\(\beta=b\)</span>.  Lets try to fit our log-log plot to a straight line.</p>
<p>Later in the semester we will develop curve fitting routines, but here is a quick one.</p>
<p>My curve fitting program is literally 2 lines long, and illustrates why sometimes one does not want to bother with a package.  I am sure it would take longer to Google the package than it does to write the function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    linearfit(X,Y,functions)</span>

<span class="s">takes a set of `X=(x1,x2,...xn)`, `Y=(y1,y1,...yn)` and a set of `functions=(f1, f2,...fm)` </span>
<span class="s">and returns the set of coefficients `C=(c1,c2,..cm)` which minimize </span>


<span class="s">         n       m</span>
<span class="s">    χ²=  ∑  (yi- ∑  cj fj(xi))^2</span>
<span class="s">        i=1     j=1</span>

<span class="s">It is implemented by constructing the `n×m` matrix `A` with matrix elements</span>

<span class="s">    Aᵢⱼ= fj(xi)</span>

<span class="s">then `(AᵗA)C=AᵗY`, where `Y=(y1,y2,...yn)`.  Thus the optimal coefficients are </span>
<span class="s">`(AᵗA)⁻¹(AᵗY)`, which can be implemented with `(AᵗA)</span><span class="se">\\</span><span class="s">(AᵗY)`.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">linearfit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">functions</span><span class="p">)</span>
<span class="w">    </span><span class="n">A</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="o">\</span><span class="p">(</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="c"># This is equivalent to (AᵗA)⁻¹(AᵗY)</span>
<span class="k">end</span><span class="w">                                        </span><span class="c"># the &quot;\&quot; is &quot;divide from left&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">linearfit</span>
</pre></div>
</div>
</div>
</div>
<p>The divide from left notation may seem a little strange on a computer, but it makes sense.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c"># The normal way to take the ratio of 1 and 2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="w"> </span><span class="o">\</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c"># an alternative way to take the ratio of 1 and 2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="c">#effectively right-multipy a row vector by the right inverse</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">\</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">;</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="c">#effectively left-multipy a column vector by the left inverse</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">lf1</span><span class="o">=</span><span class="n">linearfit</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="p">(</span><span class="n">nvals</span><span class="p">),</span><span class="n">log</span><span class="o">.</span><span class="p">(</span><span class="n">tvals</span><span class="o">.-</span><span class="mf">0.25</span><span class="p">),(</span><span class="n">x</span><span class="o">-&gt;</span><span class="mf">1.</span><span class="p">,</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>that output means that <span class="math notranslate nohighlight">\(\log(t-0.25)=-1.386 - 2\log(n)\)</span>, or in other words, <span class="math notranslate nohighlight">\(t=0.25+\exp(-1.386)n^{-2}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">scatter</span><span class="p">(</span><span class="n">nvals</span><span class="p">,</span><span class="n">tvals</span><span class="o">.-</span><span class="mf">0.25</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">L</span><span class="s">&quot;$\int_0^1x^3dx$-0.25&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">legend</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">xaxis</span><span class="o">=</span><span class="ss">:log</span><span class="p">,</span><span class="w"> </span><span class="n">yaxis</span><span class="o">=</span><span class="ss">:log</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">exp</span><span class="p">(</span><span class="n">lf1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lf1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Thus we see that the error scales as <span class="math notranslate nohighlight">\(1/n^2\)</span>.  Can we understand this?</p>
<p>Aside:  Can you write that last <code class="docutils literal notranslate"><span class="pre">plot!</span></code> statement as a <code class="docutils literal notranslate"><span class="pre">do</span></code> block?</p>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div></section>
</section>
</section>
<section id="theory-tools">
<h2>Theory tools<a class="headerlink" href="#theory-tools" title="Permalink to this heading">#</a></h2>
<section id="big-o-notation">
<h3>Big O Notation<a class="headerlink" href="#big-o-notation" title="Permalink to this heading">#</a></h3>
<p>We will often say that a function <span class="math notranslate nohighlight">\(f_n\)</span> scales as <span class="math notranslate nohighlight">\(O(n^\alpha)\)</span> as <span class="math notranslate nohighlight">\(n\to\infty\)</span>.  This means that there exists an integer <span class="math notranslate nohighlight">\(N\)</span> and a constant <span class="math notranslate nohighlight">\(C\)</span> such that <span class="math notranslate nohighlight">\(|f_n|\leq Cn^\alpha\)</span> for all <span class="math notranslate nohighlight">\(n&gt;N\)</span>.  That is, we can bound <span class="math notranslate nohighlight">\(f_n\)</span> by some constant times <span class="math notranslate nohighlight">\(n^\alpha\)</span>.  Note that this is an upper bound, and does not mean the bound is tight.</p>
<p>Here is an example showing that <code class="docutils literal notranslate"><span class="pre">y=1/(x-1)</span></code> is bounded by <code class="docutils literal notranslate"><span class="pre">2/x</span></code> for <code class="docutils literal notranslate"><span class="pre">x&gt;1</span></code>.  Thus we say <span class="math notranslate nohighlight">\(1/(x-1)=O(x^{-1})\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">fillrange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="n">fc</span><span class="o">=</span><span class="ss">:blues</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;2/x&quot;</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;1/(x-1)&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sometimes we also want to talk about tight bounds. In this course we will write <span class="math notranslate nohighlight">\(f_n\sim n^\alpha\)</span> as <span class="math notranslate nohighlight">\(n\to\infty\)</span> to mean that there exists a constant <span class="math notranslate nohighlight">\(C\)</span> such that <span class="math notranslate nohighlight">\(|f_n- C n^\alpha|\)</span> vanishes as <span class="math notranslate nohighlight">\(n\to\infty\)</span>.</p>
<p>In the case where <span class="math notranslate nohighlight">\(f_n\)</span> itself vanishes as <span class="math notranslate nohighlight">\(n\to\infty\)</span>, we actually want this to be a little bit stronger, and will actually require <span class="math notranslate nohighlight">\(|f_n-C n^\alpha|/|f_n|\)</span> vanishes as <span class="math notranslate nohighlight">\(n\to\infty\)</span>.  IE.  We want the difference between the curves to vanish faster than <span class="math notranslate nohighlight">\(f_n\)</span> itself.</p>
<p>Here is an example.  We would write <span class="math notranslate nohighlight">\(1/(x-1)\sim 1/x\)</span> as <span class="math notranslate nohighlight">\(x\to\infty\)</span>.  Note, we could also write <span class="math notranslate nohighlight">\(1/(x-1)=1/x+O(x^{-2})\)</span>, which conveys more information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">fillrange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span>
<span class="w">    </span><span class="n">fc</span><span class="o">=</span><span class="ss">:blues</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;1/x&quot;</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;1/(x-1)&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will often leave off the “<span class="math notranslate nohighlight">\(n\to\infty\)</span>” part of the statement.  Sometimes we will take a different limit – for example we could say <span class="math notranslate nohighlight">\(f(x)=O(x^{-2})\)</span> as <span class="math notranslate nohighlight">\(x\to0\)</span>, to mean that, for small <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(|f(x)|\)</span> is bounded from above by a function proportional to <span class="math notranslate nohighlight">\(x^{-2}\)</span>.</p>
<p>We can also talk about <span class="math notranslate nohighlight">\(O(g(x))\)</span> for functions other than power laws.</p>
<p>There are a <a class="reference external" href="https://en.wikipedia.org/wiki/Big_O_notation">few related notations</a> that we will not be using.</p>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div></section>
<section id="richardson-extrapolation">
<h3>Richardson Extrapolation<a class="headerlink" href="#richardson-extrapolation" title="Permalink to this heading">#</a></h3>
<p>If we know that the error in the trapezoid rule scales as <span class="math notranslate nohighlight">\(n^{-2}\)</span> we can do the integral for several values of <span class="math notranslate nohighlight">\(n\)</span> and then fit to a function of the form <span class="math notranslate nohighlight">\(I_n=I_\infty + \epsilon n^{-2}\)</span> – extracting a better approximation to the integral.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">I4</span><span class="o">=</span><span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">I8</span><span class="o">=</span><span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[
I_n=I_\infty+\epsilon n^{-2}
\]</div>
<p>We then multiply by <span class="math notranslate nohighlight">\(n^2\)</span>,</p>
<div class="amsmath math notranslate nohighlight" id="equation-09ace269-5006-4b70-bd9a-7bef509da22b">
<span class="eqno">()<a class="headerlink" href="#equation-09ace269-5006-4b70-bd9a-7bef509da22b" title="Permalink to this equation">#</a></span>\[\begin{equation}
n^2 I_n=n^2 I_\infty+\epsilon
\end{equation}\]</div>
<p>We then take two values of <span class="math notranslate nohighlight">\(n\)</span> – say
<span class="math notranslate nohighlight">\(n=4\)</span> and <span class="math notranslate nohighlight">\(n=8\)</span>.</p>
<div class="amsmath math notranslate nohighlight" id="equation-401316a8-df93-49a4-8c14-a44d204970c9">
<span class="eqno">()<a class="headerlink" href="#equation-401316a8-df93-49a4-8c14-a44d204970c9" title="Permalink to this equation">#</a></span>\[\begin{align}
4^2 I_4 &amp;= 4^2 I_\infty+\epsilon\\
8^2 I_8 &amp;= 8^2 I_\infty+\epsilon
\end{align}\]</div>
<p>Subtract these</p>
<div class="amsmath math notranslate nohighlight" id="equation-cc51ff30-26c0-4e91-8b73-88da37cf7ecd">
<span class="eqno">()<a class="headerlink" href="#equation-cc51ff30-26c0-4e91-8b73-88da37cf7ecd" title="Permalink to this equation">#</a></span>\[\begin{equation}
8^2 I_8-4^2 I_4= (8^2-4^2) I_\infty
\end{equation}\]</div>
<p>or</p>
<div class="amsmath math notranslate nohighlight" id="equation-88f9fda1-85bd-406e-a806-8abf495c80ac">
<span class="eqno">()<a class="headerlink" href="#equation-88f9fda1-85bd-406e-a806-8abf495c80ac" title="Permalink to this equation">#</a></span>\[\begin{equation}
I_\infty= \frac{8^2 I_8-4^2 I_4}{8^2-4^2} =\frac{2^2 I_8-I_4}{2^2-1}
\end{equation}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">I8</span><span class="o">-</span><span class="n">I4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This was exact in this case because of the form of the integrand.  In general, if we used <span class="math notranslate nohighlight">\(I_n\)</span> and <span class="math notranslate nohighlight">\(I_{n/2}\)</span> we would still have an error – but instead of scaling as <span class="math notranslate nohighlight">\(n^{-2}\)</span>, it would scale as <span class="math notranslate nohighlight">\(n^{-4}\)</span>.  The approximation <span class="math notranslate nohighlight">\(I\approx (4/3)I_n-(1/3)I_{n/2}\)</span> is known as <em>Simpson’s Rule</em></p>
<p>This trick can be repeated.  I can take Simpson’s rule with two different <span class="math notranslate nohighlight">\(n\)</span>’s, and combine them to get an even better approximation to the integral.  This strategy is known as Romberg Integration.  This feels a bit like a free lunch.  Somehow we can get extremely accurate integrals with relatively few function evaluations.</p>
<p><strong>Caution:</strong> Richardson extrapolation (and Romberg integration schemes) rely on our integrand being smooth.  If it is poorly behaved, then they don’t necessarily help.</p>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div></section>
<section id="euler-maclaurin-summation-formula">
<h3>Euler-Maclaurin Summation formula<a class="headerlink" href="#euler-maclaurin-summation-formula" title="Permalink to this heading">#</a></h3>
<p>A good framework for understanding these approximations in the <strong>Euler-Maclaurin Summation Formula</strong>.  Here is a somewhat formal derivation.  This is mostly for my own amusement – and this <em>derivation</em> contains one or two cheats.</p>
<p>We will first remind you about series expansions.  Analytic functions can be written in series, such as</p>
<div class="amsmath math notranslate nohighlight" id="equation-64644e63-4054-4b90-8e93-04f7a91a012b">
<span class="eqno">()<a class="headerlink" href="#equation-64644e63-4054-4b90-8e93-04f7a91a012b" title="Permalink to this equation">#</a></span>\[\begin{align}
e^x&amp;=\sum_j \frac{x^j}{j!}\\
\frac{1}{1-x}&amp;=\sum_j x^j.
\end{align}\]</div>
<p>Such a series is sometimes used to define a set of numbers.  We are going to need the Bernoulli numbers, which are defined by the series
$<span class="math notranslate nohighlight">\(
\frac{x}{e^{x}-1}=\sum_j \frac{B_j}{j!} x^j.
\)</span><span class="math notranslate nohighlight">\(
One can Brute-force expand the left hand side to get
\)</span>B_0=1<span class="math notranslate nohighlight">\(, \)</span>B_1=-1/2<span class="math notranslate nohighlight">\(, \)</span>B_2=1/6<span class="math notranslate nohighlight">\(, \)</span>B_3=0<span class="math notranslate nohighlight">\(, \)</span>B_4=-1/30,\cdots$  You can easily Google them.</p>
<p>With Bernoulli numbers in hand we will now think about operators that act on the space of functions.  They take in a function, and spit out a new function.  For example, lets intoduce <span class="math notranslate nohighlight">\(\Delta\)</span>, which is defined by <span class="math notranslate nohighlight">\((\Delta f)(x)=f(x+1)-f(x)\)</span>.  In Julia we can create this operator with</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Δ</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="n">f2</span><span class="o">=</span><span class="n">Δ</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">f1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="n">f1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>or if that notation makes you queezy, you could also write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">Δ</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">g</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="n">f2</span><span class="o">=</span><span class="n">Δ</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">f1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="n">f1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>We will next introduce <span class="math notranslate nohighlight">\(\Sigma\)</span>.  It again maps functions onto functions.  We will only need to define what it does to functions on integers.  It is defined for positive integers <span class="math notranslate nohighlight">\(x\)</span> as
$<span class="math notranslate nohighlight">\(
(\Sigma f)(x)=\sum_{n=0}^{x-1} f(n)
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">Σ</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">g</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f3</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="n">f4</span><span class="o">=</span><span class="n">Σ</span><span class="p">(</span><span class="n">f3</span><span class="p">)</span>
<span class="n">f4</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I claim that <span class="math notranslate nohighlight">\(\Delta\Sigma=I\)</span>, where <span class="math notranslate nohighlight">\(I\)</span> is the identity matrix.  To prove this one writes</p>
<div class="amsmath math notranslate nohighlight" id="equation-3579175c-38db-4bc5-8190-14de5610250c">
<span class="eqno">()<a class="headerlink" href="#equation-3579175c-38db-4bc5-8190-14de5610250c" title="Permalink to this equation">#</a></span>\[\begin{align}
(\Delta\Sigma f)(x)&amp;=(\Sigma f)(x+1)-(\Sigma f)(x)\\
&amp;=\sum_{n=0}^x f(n) - \sum_{n=0}^{x-1} f(x).
\end{align}\]</div>
<p>All of the terms cancel except the last, which gives, <span class="math notranslate nohighlight">\((\Delta\Sigma f)(x)=f(x)\)</span>, which shows that <span class="math notranslate nohighlight">\(\Delta\Sigma\)</span> is the identity operator.  This makes sense, <span class="math notranslate nohighlight">\(\Delta\)</span> and <span class="math notranslate nohighlight">\(\Sigma\)</span> are inverses of each-other.</p>
<p>In the other order, however, there is a small subtlety.  We find <span class="math notranslate nohighlight">\((\Sigma\Delta f)(x)=f(x)-f(0)\)</span>, so the order matters – unless we restrict ourself to the space of functions which vanish at the origin. You are familliar with this structure from calculus.  The integral and the derivative are inverse operations, but the integral has an arbitrary constant in it that you need to set.  Thus the derivative of the integral of a function is the identity, but the integral of the derivative is the identity plus a constant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;f&quot;</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="n">Δ</span><span class="p">(</span><span class="n">f</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Δ(f)&quot;</span><span class="p">)</span>
<span class="n">scatter!</span><span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="n">Σ</span><span class="p">(</span><span class="n">f</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Σ(f)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">scatter</span><span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="n">Σ</span><span class="p">(</span><span class="n">Δ</span><span class="p">(</span><span class="n">f</span><span class="p">)),</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Σ(Δ(f))&quot;</span><span class="p">,</span><span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;f&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">scatter</span><span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="n">Δ</span><span class="p">(</span><span class="n">Σ</span><span class="p">(</span><span class="n">f</span><span class="p">)),</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Δ(Σ(f))&quot;</span><span class="p">)</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;f&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next we introduce two more operators</p>
<div class="amsmath math notranslate nohighlight" id="equation-d2974b1b-32a7-49ee-80cd-4823d53a5fcc">
<span class="eqno">()<a class="headerlink" href="#equation-d2974b1b-32a7-49ee-80cd-4823d53a5fcc" title="Permalink to this equation">#</a></span>\[\begin{align}
(\partial f)(x)&amp;=f'(x)\\
(\smallint  f)(x)&amp;=\int_0^x f(y)dy.
\end{align}\]</div>
<p>The fundamental theorem of calculus states that <span class="math notranslate nohighlight">\(\partial\smallint=  I.\)</span>  As with the <span class="math notranslate nohighlight">\(\Sigma\)</span> and <span class="math notranslate nohighlight">\(\Delta\)</span>, if we reverse the order we get <span class="math notranslate nohighlight">\((\smallint\partial f)(x)=f(x)-f(0)\)</span>.</p>
<p>Later in the course we will develop the tools to make the functions (functionals?) <span class="math notranslate nohighlight">\(\partial\)</span> and <span class="math notranslate nohighlight">\(\smallint\)</span>.  They are clearly well defined, even if they are harder to construct than <span class="math notranslate nohighlight">\(\Sigma\)</span> and <span class="math notranslate nohighlight">\(\Delta\)</span>.</p>
<p>We now turn to Taylor’s theorem,</p>
<div class="amsmath math notranslate nohighlight" id="equation-148b8734-3907-4ae5-9e80-02e5e754f6a2">
<span class="eqno">()<a class="headerlink" href="#equation-148b8734-3907-4ae5-9e80-02e5e754f6a2" title="Permalink to this equation">#</a></span>\[\begin{align}
f(x+1)&amp;=f(x)+\sum_{n=1}^\infty \frac{(\partial^n f)(x)}{n!}\\
&amp;= (e^\partial f)(x).
\end{align}\]</div>
<p>Thus Taylor’s theorem can be written as <span class="math notranslate nohighlight">\(\Delta=e^{\partial}-1\)</span></p>
<p>Putting this together with our previous result, <span class="math notranslate nohighlight">\(\Delta\Sigma=I\)</span> yields</p>
<div class="amsmath math notranslate nohighlight" id="equation-f3725683-ef32-4a63-9ac5-b0e69f9c155f">
<span class="eqno">()<a class="headerlink" href="#equation-f3725683-ef32-4a63-9ac5-b0e69f9c155f" title="Permalink to this equation">#</a></span>\[\begin{align}
\Sigma=\frac{1}{e^\partial-1}.
\end{align}\]</div>
<p>We will now multiply the right hand side by <span class="math notranslate nohighlight">\(I=\smallint \partial \)</span> to find</p>
<div class="amsmath math notranslate nohighlight" id="equation-d680d66a-f650-4875-8280-07ca22d31f97">
<span class="eqno">()<a class="headerlink" href="#equation-d680d66a-f650-4875-8280-07ca22d31f97" title="Permalink to this equation">#</a></span>\[\begin{align}
\Sigma=\smallint\frac{\partial}{e^\partial-1} .
\end{align}\]</div>
<p>Finally we expand the right hand side in a Taylor series:</p>
<div class="amsmath math notranslate nohighlight" id="equation-8c5816b0-2787-4fba-bb04-24f7254fb3d2">
<span class="eqno">()<a class="headerlink" href="#equation-8c5816b0-2787-4fba-bb04-24f7254fb3d2" title="Permalink to this equation">#</a></span>\[\begin{align}
(\Sigma f)(x)&amp;=\left(\smallint\sum_{j=0}^\infty \frac{B_j}{j!} \partial^j f\right)(x)\\
&amp;=(\smallint f)(x) + \sum_{j=1}^\infty  \frac{B_j}{j!} \left[(\partial^{j-1} f)(x)-
(\partial^{j-1} f)(0)
\right]
\end{align}\]</div>
<p>which can be reorganized into the Euler-Maclauren summation formula</p>
<div class="amsmath math notranslate nohighlight" id="equation-65acddfb-5c45-4ff7-a78c-346adc45f708">
<span class="eqno">()<a class="headerlink" href="#equation-65acddfb-5c45-4ff7-a78c-346adc45f708" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_0^x f(y) dy &amp;= \sum_{y=0}^{x-1} f(y) - \sum_{j=1}^\infty \frac{B_j}{j!} \left[(\partial^{j-1} f)(x)-
(\partial^{j-1} f)(0)
\right]\\
&amp;= \sum_{y=0}^{x-1} f(y) + \frac{1}{2}[f(x)-f(0)] + \frac{B_2}{2} [f'(x)-f'(0)]+\cdots
\end{align}\]</div>
<p>The first two terms give you the trapezoid rule.  Subsequent terms give you corrections in terms of derivatives of the function at the bounds.</p>
<p>This may seem strange that knowledge about the behaviour of the function at the boundaries so strongly constrain the integral.  This is a peculiarity of analytic functions.</p>
<p>Finally we rescale the axis, taking the bounds of the integral to go from <span class="math notranslate nohighlight">\(a\)</span> to <span class="math notranslate nohighlight">\(b\)</span>.  Thus we define <span class="math notranslate nohighlight">\(s=a+b y/n\)</span>, and <span class="math notranslate nohighlight">\(g(s)=f(n(s-a)/b)\)</span>.  Straightforward arithmetic then gives</p>
<div class="amsmath math notranslate nohighlight" id="equation-615cf374-1594-4dfe-b4cb-9145722dc1b9">
<span class="eqno">()<a class="headerlink" href="#equation-615cf374-1594-4dfe-b4cb-9145722dc1b9" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_a^b g(s) ds &amp;= \frac{1}{n}\sum_{m=0}^{n-1} g(s_m) - \sum_{j=1}^\infty \frac{B_j}{j!}\frac{1}{n^j} \left[(\partial^{j-1} g)(b)-
(\partial^{j-1} g)(a)
\right]\\
&amp;= \frac{1}{n}\sum_{m=0}^{x-1} g(s_m) + \frac{1}{2n}[g(b)-g(a)] + \frac{B_2}{2n^2} [g'(b)-g'(a)]+O(n^{-3})
\end{align}\]</div>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div></section>
</section>
<section id="improving-our-trapezoid-rule-integrator">
<h2>Improving our trapezoid rule integrator<a class="headerlink" href="#improving-our-trapezoid-rule-integrator" title="Permalink to this heading">#</a></h2>
<p>As a reminder, here is our naive implementation of the trapezoid rule</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">naive_trap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">    </span><span class="n">xmin</span><span class="o">=</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">    </span><span class="n">xmax</span><span class="o">=</span><span class="n">range</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="w">    </span><span class="n">dx</span><span class="o">=</span><span class="p">(</span><span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="n">x1</span><span class="o">=</span><span class="n">xmin</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
<span class="w">        </span><span class="n">x2</span><span class="o">=</span><span class="n">x1</span><span class="o">+</span><span class="n">dx</span>
<span class="w">        </span><span class="n">result</span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Algorithmic Inefficiencies:</strong></p>
<ul class="simple">
<li><p>The function <code class="docutils literal notranslate"><span class="pre">f</span></code> is evaluated twice at every location.</p></li>
<li><p>We have <code class="docutils literal notranslate"><span class="pre">2n</span></code> muliplications by <code class="docutils literal notranslate"><span class="pre">dx</span></code>.</p></li>
<li><p>We don’t use Richardson</p></li>
</ul>
<p><strong>Inconveniences:</strong></p>
<ul class="simple">
<li><p>We need to specify <code class="docutils literal notranslate"><span class="pre">n</span></code>, the number of trapezoids,</p></li>
<li><p>We don’t know how accurate our result is</p></li>
</ul>
<p>Note, as discussed at the end of this notebook, there are other more subtle inefficiencies due to actual implementation by the compiler.</p>
<section id="fixing-the-most-obvious-inefficiency">
<h3>Fixing the most obvious inefficiency<a class="headerlink" href="#fixing-the-most-obvious-inefficiency" title="Permalink to this heading">#</a></h3>
<p>The factor of 2 is easy to fix.  Instead of looping over the trapezoids we loop over the points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    trap(f,range,n)</span>

<span class="s">is an implementation of the trapezoid rule for calculating</span>
<span class="s">`∫f(x)dx`, with `x` running between `a` and `b` where `range=(a,b)`.</span>
<span class="s">The integral region is divided into `n` trapezoids.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">trap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">xmin</span><span class="o">=</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">    </span><span class="n">xmax</span><span class="o">=</span><span class="n">range</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="w">    </span><span class="n">dx</span><span class="o">=</span><span class="p">(</span><span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="w"> </span>
<span class="w">    </span><span class="n">result</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">xmax</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span>
<span class="w">        </span><span class="n">result</span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="o">*</span><span class="n">dx</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p>To see a speed difference, however, one needs to go to a more complicated integrand and a very large number of trapezoids.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">sin</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span>
<span class="w">    </span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="nb">pi</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="mi">22</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">sin</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),(</span><span class="mf">0.</span><span class="p">,</span><span class="nb">pi</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="mi">22</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For smaller number of trapezoids, or simpler integrands, the time is dominated by the compiling, and this factor of 2 is irrelevant.  Note, for this example we used 4 million points – which was certainly overkill</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">^</span><span class="mi">22</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note, we can pre-compile by defining our function differently</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">sin</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="nd">@time</span><span class="w"> </span><span class="n">trap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="mi">1000</span><span class="p">)</span>
<span class="nd">@time</span><span class="w"> </span><span class="n">naive_trap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This is a good lesson: do not sweat the small stuff!</p>
</section>
<section id="dynamic-step-size">
<h3>Dynamic step size<a class="headerlink" href="#dynamic-step-size" title="Permalink to this heading">#</a></h3>
<p>Lets implement a strategy from <em>Numerical Recipies</em> which does the Trapezoid rule with dynamic step sizes</p>
<p>One reason I want to go through it, is that it introduces some useful computer science – namely using <em>objects</em>.  <em>Objects</em> are the nouns of programs – just as <em>functions</em> are the verbs.  There are less sophisticated ways to implement this approach, but I hope to start introducing some machinery that will be useful.</p>
<p>The trapezoid rule subdivides the integral into <span class="math notranslate nohighlight">\(n=2^m\)</span> trapezoids.  We are going to sequentially increase <span class="math notranslate nohighlight">\(m\)</span> until we achieve our desired accuracy.  In order to do this we define an object <code class="docutils literal notranslate"><span class="pre">trap_data</span></code> which stores information about the integral that you are using, and an interim result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    trap_data(f,range)</span>

<span class="s">stores the intermediate information for our trapezoid rule. </span>

<span class="s">Fields:</span>
<span class="s">    f       # store the function we are integrating</span>
<span class="s">    range   # store the range (a,b)</span>
<span class="s">    val     # trapezoid rule integral at current depth, m</span>
<span class="s">    m       # depth -- number of trapezoids = 2ᵐ</span>

<span class="s">To increase the depth use command `subdivide!` or `subdivide`.</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="k">mutable</span><span class="w"> </span><span class="k">struct</span> <span class="kt">trap_data</span>
<span class="w">    </span><span class="n">f</span><span class="w">       </span><span class="c"># store the function we are integrating</span>
<span class="w">    </span><span class="n">range</span><span class="w">   </span><span class="c"># store the range (a,b)</span>
<span class="w">    </span><span class="n">val</span><span class="w">     </span><span class="c"># trapezoid rule integral at current depth, m</span>
<span class="w">    </span><span class="n">m</span><span class="w">       </span><span class="c"># depth -- number of trapezoids = 2ᵐ</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">trap_data</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">)</span>
<span class="w">        </span><span class="n">new</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,(</span><span class="n">f</span><span class="p">(</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">range</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">range</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="s">    subdivide!(data ::trap_data)</span>
<span class="s">takes a `trapdata` object, and doubles the number of gridpoints in the integral.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">subdivide!</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">::</span><span class="kt">trap_data</span><span class="p">)</span>
<span class="w">    </span><span class="c"># Extract needed info from `data`</span>
<span class="w">    </span><span class="n">f</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">f</span>
<span class="w">    </span><span class="n">m</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span>
<span class="w">    </span><span class="n">result</span><span class="o">=</span><span class="n">zero</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">range</span>
<span class="w">    </span><span class="c"># Width of new rectangles</span>
<span class="w">    </span><span class="n">dx</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">dx</span><span class="o">:</span><span class="n">dx</span><span class="o">*</span><span class="mi">2</span><span class="o">:</span><span class="n">dx</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">result</span><span class="o">+=</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="o">+</span><span class="n">data</span><span class="o">.</span><span class="n">val</span><span class="o">/</span><span class="mi">2</span>
<span class="w">    </span><span class="c"># Update data</span>
<span class="w">    </span><span class="n">data</span><span class="o">.</span><span class="n">m</span><span class="o">=</span><span class="n">m</span>
<span class="w">    </span><span class="n">data</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="n">result</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mf">0.5</span><span class="o">:</span><span class="mi">25</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p>We will learn more about this syntax as the course progresses.  Nevertheless, to see how this work, we create one of our data objects</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">td1</span><span class="o">=</span><span class="n">trap_data</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can extract the stored information with a dot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">td1</span><span class="o">.</span><span class="n">range</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">td1</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">=</span><span class="n">td1</span><span class="o">.</span><span class="n">f</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">=</span><span class="n">td1</span><span class="o">.</span><span class="n">range</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">td1</span><span class="o">.</span><span class="n">val</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">td1</span><span class="o">.</span><span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">naive_trap</span><span class="p">(</span><span class="n">td1</span><span class="o">.</span><span class="n">f</span><span class="p">,</span><span class="n">td1</span><span class="o">.</span><span class="n">range</span><span class="p">,</span><span class="mi">2</span><span class="o">^</span><span class="n">td1</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can then use the <code class="docutils literal notranslate"><span class="pre">subdivide!</span></code> function to break the integral into more pieces</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">subdivide!</span><span class="p">(</span><span class="n">td1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">td1</span><span class="o">.</span><span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">td1</span><span class="o">.</span><span class="n">m</span><span class="p">,</span><span class="n">td1</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="n">td1</span><span class="o">.</span><span class="n">m</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">subdivide!</span><span class="p">(</span><span class="n">td1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">td1</span><span class="o">.</span><span class="n">m</span><span class="p">,</span><span class="n">td1</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="n">td1</span><span class="o">.</span><span class="n">m</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Every time we call subdivide we increase the number of trapezoids.  However, we just evaluate <code class="docutils literal notranslate"><span class="pre">f</span></code> at the new points.</p>
<p>We now just need to wrap this in a function which calls subdivide until we hit some convergence criterion.  We will use that the fractional change in the integral falls below some threshold – that we will call <code class="docutils literal notranslate"><span class="pre">eps</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">`nrtrap(f,range;namedargs...)`</span>

<span class="s">Uses the trapezoid rule algorithm from Numerical Recipies to calculate ``</span><span class="se">\\</span><span class="s">int_a^b f(x) dx``</span>
<span class="s">where `range=(a,b)`.</span>

<span class="s">`namedargs`</span>
<span class="s">- `eps=1E-10`: algorithm terminates when relative change in integral falls below `eps`</span>
<span class="s">- `max_divisions=20`: make no more than `max_divisions` subdivisions</span>
<span class="s">- `debug=false`: set to `true` to see debug informations</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">nrtrap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">;</span><span class="n">eps</span><span class="o">=</span><span class="mf">1E-10</span><span class="p">,</span><span class="n">max_divisions</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">debug</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="w">    </span><span class="n">data</span><span class="o">=</span><span class="n">trap_data</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">)</span>
<span class="w">    </span><span class="n">oldval</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">    </span><span class="n">val</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">max_divisions</span>
<span class="w">        </span><span class="n">oldval</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span>
<span class="w">        </span><span class="n">subdivide!</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="w">        </span><span class="n">val</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="o">-</span><span class="n">oldval</span><span class="p">)</span><span class="o">&lt;</span><span class="n">eps</span><span class="o">*</span><span class="n">abs</span><span class="p">(</span><span class="n">oldval</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">oldval</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">debug</span>
<span class="w">                </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;converged after &quot;</span><span class="o">*</span><span class="n">string</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="s">&quot; iterations&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">val</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Did not converge to precision </span><span class="si">$eps</span><span class="s"> &quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s">&quot;after </span><span class="si">$max_divisions</span><span class="s"> subdivisions.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s">&quot;Previous 2 results: (</span><span class="si">$oldval</span><span class="s">,</span><span class="si">$val</span><span class="s">)</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;Try increasing number of divisions or applying a tranformation to integrand.&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Question?</strong>  Why does it make sense to use that stopping criterion?</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>abs(val-oldval)&lt;eps*abs(oldval)
</pre></div>
</div>
<p>When might it make less sense?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;a&quot;</span><span class="o">*</span><span class="s">&quot;b&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">nrtrap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">nrtrap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="n">max_divisions</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It is a simple change to upgrade this to Simpson’s rule</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">`nrsimp(f,range;namedargs...)`</span>

<span class="s">Uses the Simpson&#39;s rule algorithm from Numerical Recipies to calculate ``</span><span class="se">\\</span><span class="s">int_a^b f(x) dx``</span>
<span class="s">where `range=(a,b)`.</span>

<span class="s">`namedargs`</span>
<span class="s">- `eps=1E-10`: algorithm terminates when relative change in integral falls below `eps`</span>
<span class="s">- `max_divisions=20`: make no more than `max_divisions` subdivisions</span>
<span class="s">- `debug=false`: set to `true` to see debug informations</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">nrsimp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">;</span><span class="n">eps</span><span class="o">=</span><span class="mf">1E-10</span><span class="p">,</span><span class="n">max_divisions</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">debug</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="w">    </span><span class="n">data</span><span class="o">=</span><span class="n">trap_data</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">)</span>
<span class="w">    </span><span class="n">oldtrapval</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span>
<span class="w">    </span><span class="n">subdivide!</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="w">    </span><span class="n">trapval</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span>
<span class="w">    </span><span class="n">sval</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">trapval</span><span class="o">-</span><span class="n">oldtrapval</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<span class="w">    </span><span class="n">oldsval</span><span class="o">=</span><span class="n">sval</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="n">max_divisions</span>
<span class="w">        </span><span class="n">oldtrapval</span><span class="o">=</span><span class="n">trapval</span>
<span class="w">        </span><span class="n">oldsval</span><span class="o">=</span><span class="n">sval</span>
<span class="w">        </span><span class="n">subdivide!</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="w">        </span><span class="n">trapval</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span>
<span class="w">        </span><span class="n">sval</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">trapval</span><span class="o">-</span><span class="n">oldtrapval</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">sval</span><span class="o">-</span><span class="n">oldsval</span><span class="p">)</span><span class="o">&lt;</span><span class="n">eps</span><span class="o">*</span><span class="n">abs</span><span class="p">(</span><span class="n">oldsval</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">sval</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">oldsval</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">debug</span>
<span class="w">                </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;converged after &quot;</span><span class="o">*</span><span class="n">string</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="s">&quot; iterations&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">sval</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Did not converge to precision </span><span class="si">$eps</span><span class="s"> &quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s">&quot;after </span><span class="si">$max_divisions</span><span class="s"> subdivisions.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s">&quot;Previous 2 results: (</span><span class="si">$oldsval</span><span class="s">,</span><span class="si">$sval</span><span class="s">)</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;Try increasing number of divisions or applying a tranformation to integrand.&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">nrsimp</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">nrtrap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">^</span><span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">^</span><span class="mi">18</span>
</pre></div>
</div>
</div>
</div>
<div style="border: 2px solid white; border-radius: 10px; padding: 20px; background-color:white; color:black; height: 500px" >
</div></section>
</section>
<section id="optimization">
<h2>Optimization<a class="headerlink" href="#optimization" title="Permalink to this heading">#</a></h2>
<p>I probably won’t get to this in class – but you may find it useful to read.</p>
<p><strong>Note:  In general optimization is the last thing your should worry about.</strong></p>
<p>First, in a complex program there is usually one or two rate limiting steps.  It is hard to predict what these will be <em>a-priori</em>.  Optimization of any part of the code, except those rate limiting steps, is wasted.</p>
<p>Second, optimization is complicated.  It depends on not only the programming language, but the implementation of the language, the compiler, the compiler directives…  It is often a trial and error process – and sometime you discover that your new approach is slower than the old.  In general clean simple code will be fast.</p>
<p>Regardless, lets now see how we are doing with speed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">nrtrap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Oh no! Our fancy version is about 8 times slower than our naive version.  Things are even worse if I use a pre-compiled function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">nrtrap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">naive_trap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Fixing this is non-trivial, as the speed of these routines depends on low level internals.  If you look at the <code class="docutils literal notranslate"><span class="pre">&#64;time</span></code> statement for our <code class="docutils literal notranslate"><span class="pre">naive-trap</span></code> function, you see that the bulk of the time there is taken in compilation (when we feed in a pure function which is therefore not precompiled).</p>
<p>There is a more reliable – but slower – timing tool which will run the program multiple times, and subtract off the compilation time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">BenchmarkTools</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@btime</span><span class="w"> </span><span class="n">naive_trap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@btime</span><span class="w"> </span><span class="n">naive_trap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@btime</span><span class="w"> </span><span class="n">nrtrap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@btime</span><span class="w"> </span><span class="n">nrtrap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>One clue to the problem is that in <code class="docutils literal notranslate"><span class="pre">nrtrap</span></code> we are seeing a large number of <code class="docutils literal notranslate"><span class="pre">Heap</span> <span class="pre">allocations</span></code>.  This has to do with the way the fact that we are passing around a function object inside a struct, and the just-in-time compiler does not know what data type the function returns.  Thus it has to allocate memory in a generic way.</p>
<p>We can fix some of this by compartmentalizing the function calls in our <code class="docutils literal notranslate"><span class="pre">subdivide!</span></code> method – making what is known as a “function barrier.”  This is an optimization trick which is unique to Julia.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    alt3_trap_data(f,range)</span>

<span class="s">stores the intermediate information for our trapezoid rule. </span>

<span class="s">Fields:</span>
<span class="s">    f       # store the function we are integrating</span>
<span class="s">    range   # store the range (a,b)</span>
<span class="s">    val     # trapezoid rule integral at current depth, m</span>
<span class="s">    m       # depth -- number of trapezoids = 2ᵐ</span>

<span class="s">To increase the depth use command `subdivide!` or `subdivide`.</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="k">mutable</span><span class="w"> </span><span class="k">struct</span> <span class="kt">alt3_trap_data</span>
<span class="w">    </span><span class="n">f</span><span class="w">       </span><span class="c"># store the function we are integrating</span>
<span class="w">    </span><span class="n">range</span><span class="w">   </span><span class="c"># store the range (a,b)</span>
<span class="w">    </span><span class="n">val</span><span class="w">     </span><span class="c"># trapezoid rule integral at current depth, m</span>
<span class="w">    </span><span class="n">m</span><span class="w">       </span><span class="c"># depth -- number of trapezoids = 2ᵐ</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">alt3_trap_data</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">)</span>
<span class="w">        </span><span class="n">new</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,(</span><span class="n">f</span><span class="p">(</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">range</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">range</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">subdivide!</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">::</span><span class="kt">alt3_trap_data</span><span class="p">)</span>
<span class="w">    </span><span class="c"># Extract needed info from `data`</span>
<span class="w">    </span><span class="n">f</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">f</span>
<span class="w">    </span><span class="n">m</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span>
<span class="w">    </span><span class="n">range</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">range</span>
<span class="w">    </span><span class="n">nextresult</span><span class="o">=</span><span class="n">sum_even_points</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="c"># compiler will generate code for this function which is specialized to the arguments</span>
<span class="w">    </span><span class="n">result</span><span class="o">=</span><span class="n">nextresult</span><span class="o">+</span><span class="n">data</span><span class="o">.</span><span class="n">val</span><span class="o">/</span><span class="mi">2</span>
<span class="w">    </span><span class="c"># Update data</span>
<span class="w">    </span><span class="n">data</span><span class="o">.</span><span class="n">m</span><span class="o">=</span><span class="n">m</span>
<span class="w">    </span><span class="n">data</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="n">result</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">sum_even_points</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">=</span><span class="n">range</span>
<span class="w">    </span><span class="n">dx</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="w">    </span><span class="n">result</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span>
<span class="w">        </span><span class="n">result</span><span class="o">+=</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">j</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span>
<span class="k">end</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="s">`alt3_nrtrap(f,range;namedargs...)`</span>

<span class="s">Uses the trapezoid rule algorithm from Numerical Recipies to calculate ``</span><span class="se">\\</span><span class="s">int_a^b f(x) dx``</span>
<span class="s">where `range=(a,b)`.</span>

<span class="s">`namedargs`</span>
<span class="s">- `eps=1E-10`: algorithm terminates when relative change in integral falls below `eps`</span>
<span class="s">- `max_divisions=20`: make no more than `max_divisions` subdivisions</span>
<span class="s">- `debug=false`: set to `true` to see debug informations</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">alt3_nrtrap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">;</span><span class="n">eps</span><span class="o">=</span><span class="mf">1E-10</span><span class="p">,</span><span class="n">max_divisions</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">debug</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="w">    </span><span class="n">data</span><span class="o">=</span><span class="n">alt3_trap_data</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">)</span>
<span class="w">    </span><span class="n">oldval</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">    </span><span class="n">val</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">max_divisions</span>
<span class="w">        </span><span class="n">oldval</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span>
<span class="w">        </span><span class="n">subdivide!</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="w">        </span><span class="n">val</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="o">-</span><span class="n">oldval</span><span class="p">)</span><span class="o">&lt;</span><span class="n">eps</span><span class="o">*</span><span class="n">abs</span><span class="p">(</span><span class="n">oldval</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">oldval</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">debug</span>
<span class="w">                </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;converged after &quot;</span><span class="o">*</span><span class="n">string</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="s">&quot; iterations&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">val</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Did not converge to precision &quot;</span><span class="o">*</span><span class="n">string</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span><span class="o">*</span>
<span class="w">          </span><span class="s">&quot;after &quot;</span><span class="o">*</span><span class="n">string</span><span class="p">(</span><span class="n">max_divisions</span><span class="p">)</span><span class="o">*</span><span class="s">&quot; subdivisions.&quot;</span><span class="o">*</span>
<span class="w">          </span><span class="s">&quot;previous 2 results: (&quot;</span><span class="o">*</span><span class="n">string</span><span class="p">(</span><span class="n">oldval</span><span class="p">)</span><span class="o">*</span>
<span class="w">          </span><span class="s">&quot;,&quot;</span><span class="o">*</span><span class="n">string</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">*</span><span class="s">&quot;)&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">nrtrap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">alt3_nrtrap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Apparently we got somewhere between a factor of 5-10 speedup</p>
<p>We can do even better if we precompile (or use <code class="docutils literal notranslate"><span class="pre">&#64;btime</span></code> to get rid of the compilation timing)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">nrtrap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">alt3_nrtrap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This gave us another 2 orders of magnitude in speed!!  Note the drastic reduction in heap allocations.  We are now competitive with the simplest implementation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span><span class="w"> </span><span class="n">trap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Optimization is hard!</strong></p>
<p>The real magic here is that Julia is able to figure out the return type of the function and uses that information to optimize things.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Base</span><span class="o">.</span><span class="n">return_types</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="kt">Float64</span><span class="p">,))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Base</span><span class="o">.</span><span class="n">return_types</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,(</span><span class="kt">Float64</span><span class="p">,))</span>
</pre></div>
</div>
</div>
</div>
<p>The process of type-hinting occurs when the function is an argument of another function.  If we bury the function inside a <code class="docutils literal notranslate"><span class="pre">struct</span></code>, the compiler never does the type-hinting.  Later in the course we will learn about how to create <code class="docutils literal notranslate"><span class="pre">struct</span></code> objects which know about the types of their contents, and don’t have this performance hit.  The <code class="docutils literal notranslate"><span class="pre">function</span> <span class="pre">barrier</span></code> approach though is always good to have in your pocket.</p>
<p>The other strategy which would work here is to not store <code class="docutils literal notranslate"><span class="pre">f</span></code> in our <code class="docutils literal notranslate"><span class="pre">struct</span></code>, but instead pass around 2 arguments: <code class="docutils literal notranslate"><span class="pre">f</span></code> and the data.  We also need to give concrete types to <code class="docutils literal notranslate"><span class="pre">range</span></code>, <code class="docutils literal notranslate"><span class="pre">val</span></code>, and <code class="docutils literal notranslate"><span class="pre">m</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    alt2_trap_data{R,D}(f,range)</span>

<span class="s">stores the intermediate information for our trapezoid rule. </span>

<span class="s">Fields:</span>
<span class="s">    range   # store the range (a,b)</span>
<span class="s">    val     # trapezoid rule integral at current depth, m</span>
<span class="s">    m       # depth -- number of trapezoids = 2ᵐ</span>

<span class="s">To increase the depth use command `subdivide!` or `subdivide`.</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="k">mutable</span><span class="w"> </span><span class="k">struct</span> <span class="kt">alt2_trap_data</span><span class="p">{</span><span class="kt">D</span><span class="p">,</span><span class="kt">R</span><span class="p">}</span><span class="w">   </span><span class="c"># Parameterized type:  D=domain, R=range</span>
<span class="w">    </span><span class="n">range</span><span class="w">  </span><span class="o">::</span><span class="kt">Tuple</span><span class="p">{</span><span class="kt">D</span><span class="p">,</span><span class="kt">D</span><span class="p">}</span><span class="w">              </span><span class="c"># store the range (a,b)</span>
<span class="w">    </span><span class="n">val</span><span class="w">    </span><span class="o">::</span><span class="kt">R</span><span class="w">                       </span><span class="c"># trapezoid rule integral at current depth, m</span>
<span class="w">    </span><span class="n">m</span><span class="w">      </span><span class="o">::</span><span class="kt">Int64</span><span class="w">                   </span><span class="c"># depth -- number of trapezoids = 2ᵐ</span>
<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="n">alt2_trap_data</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">)</span>
<span class="w">        </span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="o">=</span><span class="n">range</span>
<span class="w">        </span><span class="n">f1</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
<span class="w">        </span><span class="n">f2</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
<span class="w">        </span><span class="n">trap</span><span class="o">=</span><span class="p">(</span><span class="n">f1</span><span class="o">+</span><span class="n">f2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1</span><span class="o">+</span><span class="n">r2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="w">        </span><span class="kt">new</span><span class="p">{</span><span class="kt">typeof</span><span class="p">((</span><span class="kt">r2</span><span class="o">-</span><span class="kt">r1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="kt">typeof</span><span class="p">(</span><span class="kt">trap</span><span class="p">)}(</span><span class="n">range</span><span class="p">,</span><span class="n">trap</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="s">    subdivide!(f,data ::alt_trap_data)</span>
<span class="s">takes a `trapdata` object, and doubles the number of gridpoints in the integral.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">subdivide!</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">::</span><span class="kt">alt2_trap_data</span><span class="p">)</span>
<span class="w">    </span><span class="c"># Extract needed info from `data`</span>
<span class="w">    </span><span class="n">m</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span>
<span class="w">    </span><span class="n">result</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span><span class="o">/</span><span class="mi">2</span>
<span class="w">    </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">range</span>
<span class="w">    </span><span class="c"># Width of new rectangles</span>
<span class="w">    </span><span class="n">dx</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">dx</span><span class="o">:</span><span class="n">dx</span><span class="o">*</span><span class="mi">2</span><span class="o">:</span><span class="n">dx</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">result</span><span class="o">+=</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="c"># Update data</span>
<span class="w">    </span><span class="n">data</span><span class="o">.</span><span class="n">m</span><span class="o">=</span><span class="n">m</span>
<span class="w">    </span><span class="n">data</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="n">result</span>
<span class="k">end</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="s">`alt_nrtrap(f,range;namedargs...)`</span>

<span class="s">Uses the trapezoid rule algorithm from Numerical Recipies to calculate ``</span><span class="se">\\</span><span class="s">int_a^b f(x) dx``</span>
<span class="s">where `range=(a,b)`.</span>

<span class="s">`namedargs`</span>
<span class="s">- `eps=1E-10`: algorithm terminates when relative change in integral falls below `eps`</span>
<span class="s">- `max_divisions=20`: make no more than `max_divisions` subdivisions</span>
<span class="s">- `debug=false`: set to `true` to see debug informations</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">alt2_nrtrap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">;</span><span class="n">eps</span><span class="o">=</span><span class="mf">1E-10</span><span class="p">,</span><span class="n">max_divisions</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">debug</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="w">    </span><span class="n">data</span><span class="o">=</span><span class="n">alt2_trap_data</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">range</span><span class="p">)</span>
<span class="w">    </span><span class="n">oldval</span><span class="o">=</span><span class="n">zero</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="w">    </span><span class="n">val</span><span class="o">=</span><span class="n">oldval</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">max_divisions</span>
<span class="w">        </span><span class="n">oldval</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span>
<span class="w">        </span><span class="n">subdivide!</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="w">        </span><span class="n">val</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">val</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="o">-</span><span class="n">oldval</span><span class="p">)</span><span class="o">&lt;</span><span class="n">eps</span><span class="o">*</span><span class="n">abs</span><span class="p">(</span><span class="n">oldval</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">oldval</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">debug</span>
<span class="w">                </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;converged after &quot;</span><span class="o">*</span><span class="n">string</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="s">&quot; iterations&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">val</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Did not converge to precision </span><span class="si">$eps</span><span class="s"> &quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s">&quot;after </span><span class="si">$max_divisions</span><span class="s"> subdivisions.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s">&quot;Previous 2 results: (</span><span class="si">$oldval</span><span class="s">,</span><span class="si">$val</span><span class="s">)</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;Try increasing number of divisions or applying a tranformation to integrand.&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="nd">@btime</span><span class="w"> </span><span class="n">alt2_nrtrap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@btime</span><span class="w"> </span><span class="n">alt2_nrtrap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@btime</span><span class="w"> </span><span class="n">alt3_nrtrap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="n">debug</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@btime</span><span class="w"> </span><span class="n">trap</span><span class="p">(</span><span class="n">h</span><span class="p">,(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span><span class="mi">2</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Apparently the <code class="docutils literal notranslate"><span class="pre">alt3</span></code> version is nearly optimal. I can’t say I understand why it is almost a factor of 2 faster than <code class="docutils literal notranslate"><span class="pre">alt2</span></code>.  One could also try a more pedestrian version that doesn’t use <code class="docutils literal notranslate"><span class="pre">struct</span></code>’s.  We should also do some more testing to see if the timing depends on the complexity of the function.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.10"
        },
        kernelOptions: {
            name: "julia-1.10",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.10'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Install.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installing Julia</p>
      </div>
    </a>
    <a class="right-next"
       href="blankLAB%20Period%20of%20a%20Pendulum.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab – Period of a Pendulum</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adimensionalizing">Adimensionalizing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strategies">Strategies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-approaches-to-numerical-quadratures">Simple approaches to numerical quadratures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-implementation-of-trapezoid-rule">Naive implementation of trapezoid rule</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-n">Choosing <code class="docutils literal notranslate"><span class="pre">n</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theory-tools">Theory tools</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#big-o-notation">Big O Notation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#richardson-extrapolation">Richardson Extrapolation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#euler-maclaurin-summation-formula">Euler-Maclaurin Summation formula</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#improving-our-trapezoid-rule-integrator">Improving our trapezoid rule integrator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fixing-the-most-obvious-inefficiency">Fixing the most obvious inefficiency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-step-size">Dynamic step size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization">Optimization</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Erich Mueller
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>