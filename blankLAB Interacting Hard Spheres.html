

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>LAB – Interacting Hard Spheres &#8212; PHYS 4480-7680 Computational Physics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'blankLAB Interacting Hard Spheres';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Kinetic Theory of Gases" href="ktheory.html" />
    <link rel="prev" title="Billiards" href="Billiards.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="PHYS 4480-7680 Computational Physics - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="PHYS 4480-7680 Computational Physics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Physics 4480 / 7680 / Astronomy 7690
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Notebook%20Workflow.html">Notebook Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="Logistics.html">Logistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">Installing Julia</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quadratures -- Period of a Pendulum</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Period%20of%20a%20pendulum.html">Period of a Pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Period%20of%20a%20Pendulum.html">Lab – Period of a Pendulum</a></li>




<li class="toctree-l1"><a class="reference internal" href="Integration%20Followup.html">Integration Follow-up</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Solving Ordinary Differential Equations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Pendulum%20dynamics.html">Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Projectile%20Motion.html">LAB – Projectile Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="Automatic%20Differentiation.html">Automatic Differentiation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Classical Mechanics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Symplectic%20Integrators.html">Symmetry Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Chaos.html">LAB – Chaos</a></li>
<li class="toctree-l1"><a class="reference internal" href="Duffing%20Oscillator%20Followup.html">Followup on Duffing Oscillator</a></li>
<li class="toctree-l1"><a class="reference internal" href="Animating%20a%20Pendulum.html">Interactive Animation of Pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="blankLAB%20Animating%20the%20Duffing%20Oscillator.html">Lab – Animating the Duffing Oscillator</a></li>
<li class="toctree-l1"><a class="reference internal" href="More%20Duffing.html">Exploring Chaos with our Duffing Simulator</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Dynamical Systems without differential equations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Billiards.html">Billiards</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">LAB – Interacting Hard Spheres</a></li>
<li class="toctree-l1"><a class="reference internal" href="ktheory.html">Kinetic Theory of Gases</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Stochastic Methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Stochastic Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="monte%20carlo%20integration.html">Stochastic approaches to integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metropolis%20Ising%20Model.html">2D Ising Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Correlation%20Times.html">Correlation times</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/blankLAB Interacting Hard Spheres.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>LAB – Interacting Hard Spheres</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-in-packages-and-set-up-logger">Load in Packages, and set up logger</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goal">Goal</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-interacting-hard-spheres">
<h1>LAB – Interacting Hard Spheres<a class="headerlink" href="#lab-interacting-hard-spheres" title="Permalink to this heading">#</a></h1>
<p><strong>Please write your name in this box</strong></p>
<p><em>We encourage you to work together, and seek whatever help you need in completing this lab.  Please list all people who you worked with or received help from</em></p>
<p><em>We encourage you to use any online resources that you find useful. Please list any URL’s that you consulted</em></p>
<p><em>We encourage you to use AI resources if you find them useful.  If you made use of AI, please list the platform and the prompts which you made use of</em></p>
<section id="load-in-packages-and-set-up-logger">
<h2>Load in Packages, and set up logger<a class="headerlink" href="#load-in-packages-and-set-up-logger" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Plots</span><span class="p">,</span><span class="n">Logging</span><span class="p">,</span><span class="n">ProgressMeter</span><span class="p">,</span><span class="n">LinearAlgebra</span>
</pre></div>
</div>
</div>
</div>
<p>Set up Logger</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">default_logger</span><span class="o">=</span><span class="n">global_logger</span><span class="p">()</span>
<span class="n">debug_logger</span><span class="o">=</span><span class="n">ConsoleLogger</span><span class="p">(</span><span class="nb">stderr</span><span class="p">,</span><span class="w"> </span><span class="n">Logging</span><span class="o">.</span><span class="n">Debug</span><span class="p">);</span><span class="w"> </span><span class="c"># set up logger</span>
</pre></div>
</div>
</div>
</div>
<p>To turn on debug logger as the global logger type</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>global_logger(debug_logger)
</pre></div>
</div>
<p>to turn it off type</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>global_logger(default_logger)
</pre></div>
</div>
</section>
<section id="goal">
<h2>Goal<a class="headerlink" href="#goal" title="Permalink to this heading">#</a></h2>
<p>Here you are going to upgrade our Billiard code to handle interacting hard spheres.  By simulating a large number of such spheres we will be able to explore the kinetic theory of gases, and start thinking about statistical mechanics.</p>
<p>We will again do an <code class="docutils literal notranslate"><span class="pre">event</span> <span class="pre">driven</span> <span class="pre">simulation</span></code>.  Each ball will have a <code class="docutils literal notranslate"><span class="pre">nextevent</span></code> attribute, which tells what it will next bounce off of, and when.</p>
<p>At each step in the main loop we will figure out which ball has the next collision event – which could be bouncing off of a wall, or it could be bouncing off of another ball.  We then time evolve up to that point.  We then update all of the <code class="docutils literal notranslate"><span class="pre">nextevent</span></code> fields, and repeat.</p>
<p>We will first do a naive update method which scales quadratically with the number of spheres, <span class="math notranslate nohighlight">\(O(N^2)\)</span>.  We will then improve that to a linear method, <span class="math notranslate nohighlight">\(O(N)\)</span>.  We will discuss a <span class="math notranslate nohighlight">\(O(N^0)\)</span> method, but will not implement it, as it is a bit of a pain, and our <span class="math notranslate nohighlight">\(O(N)\)</span> approach is fast enough for what we want to do.</p>
<p>The simulation we are producing here can be described as “hard sphere molecular dynamics”</p>
<p>You will probably want the <code class="docutils literal notranslate"><span class="pre">Billiards.ipynb</span></code> file open while you work on this, as we follow a very similar plan here.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 1
</h2><p>We will use a <code class="docutils literal notranslate"><span class="pre">Ball</span></code> class with the following fields:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mutable struct Ball
    x
    y 
    vx 
    vy 
    radius 
    nextevent 
end
</pre></div>
</div>
<p>This is similar to our previous Ball class – but since we are going to have multiple balls, there is no sense having each one keep track of time.  We also added two new attributes, <code class="docutils literal notranslate"><span class="pre">radius</span></code> and  <code class="docutils literal notranslate"><span class="pre">nextevent</span></code>.  These are the ball’s radius, and the object which describes the next collision event.</p>
<p>For efficiency reason, we are going to hard-code the types for these fields.  (We get about a factor of 5 speedup compared to leaving them untyped.  This is because the compiler can optimize some of the code.)  Thus we need to define a “Null Event” object, which can be our default <code class="docutils literal notranslate"><span class="pre">Event</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">abstract</span><span class="w"> </span><span class="k">type</span> <span class="kt">Event</span><span class="w"> </span><span class="k">end</span>

<span class="k">struct</span> <span class="kt">NullEvent</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Event</span>
<span class="w">    </span><span class="n">t</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="k">end</span>

<span class="n">NE</span><span class="o">=</span><span class="n">NullEvent</span><span class="p">(</span><span class="nb">Inf</span><span class="p">)</span>

<span class="k">mutable</span><span class="w"> </span><span class="k">struct</span> <span class="kt">Ball</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="w">    </span><span class="n">vx</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="w">    </span><span class="n">vy</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="w">    </span><span class="n">radius</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="w">    </span><span class="n">nextevent</span><span class="w"> </span><span class="o">::</span><span class="kt">Event</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p>This is similar to our previous Ball class – but since we are going to have multiple balls, there is no sense having each one keep track of time.  We also added two new attributes, <code class="docutils literal notranslate"><span class="pre">radius</span></code> and  <code class="docutils literal notranslate"><span class="pre">nextevent</span></code>.  These are the ball’s radius, and the object which describes the next collision event.</p>
<p>Based off of the lecture definition, write the following methods:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>set_xv!
set_r!
set_v!
get_r
get_v
</pre></div>
</div>
<p>Also, overload <code class="docutils literal notranslate"><span class="pre">Base.show</span></code>, and make convenience constructors for the <code class="docutils literal notranslate"><span class="pre">Ball</span></code> class.  As a default you can set <code class="docutils literal notranslate"><span class="pre">nextevent</span></code> equal to <code class="docutils literal notranslate"><span class="pre">NE</span></code>.</p>
<p>Test these methods.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 2
</h2><p>Here are our <code class="docutils literal notranslate"><span class="pre">Hwall</span></code> and <code class="docutils literal notranslate"><span class="pre">Vwall</span></code> classes.  We will not use <code class="docutils literal notranslate"><span class="pre">Cwall</span></code> in this lab, but if we write everything correctly, it should still work.  As with the <code class="docutils literal notranslate"><span class="pre">Ball</span></code> class, I am hard-coding the type declaration for the positions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">abstract</span><span class="w"> </span><span class="k">type</span> <span class="kt">Wall</span><span class="w"> </span><span class="k">end</span>

<span class="k">struct</span> <span class="kt">Hwall</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Wall</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="k">end</span>

<span class="k">struct</span> <span class="kt">Vwall</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Wall</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p>As in lecture need an <code class="docutils literal notranslate"><span class="pre">impact_time</span></code> method, which finds the but we will need to change it so that it takes 3 variables <code class="docutils literal notranslate"><span class="pre">impact_time(w::Hwall,b::Ball,t)</span></code> – since our <code class="docutils literal notranslate"><span class="pre">Ball</span></code> objects do not store the time.</p>
<p>Also, since the balls now have finite radius, you need to change the <code class="docutils literal notranslate"><span class="pre">impact-time</span></code> definition so that the collision happens when the edge of the ball hits the wall, not the center.  Here is how I implemented it for the horizontal wall:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>function impact_time(w::Hwall,b::Ball,t)
    dy=w.y-b.y
    return (dy-sign(b.vy)*b.radius)/b.vy+t
end
</pre></div>
</div>
<p>Write the <code class="docutils literal notranslate"><span class="pre">impact-time</span></code> method, and test it.  Make a <em>method</em> so that you can call <code class="docutils literal notranslate"><span class="pre">impact-time</span></code> with the Wall and Ball in arbitrary order.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 3
</h2><p>Next we need to define a method</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>impact_time(b1::Ball,b2::Ball,t)
</pre></div>
</div>
<p>which tells us when 2 balls will collide.  You should be able to do this by calling the <code class="docutils literal notranslate"><span class="pre">circ_time</span></code> function that we made in class.</p>
<p>We will need to call it with <code class="docutils literal notranslate"><span class="pre">r0=r1-r2</span></code>, <code class="docutils literal notranslate"><span class="pre">v=v1-v2</span></code>, and <code class="docutils literal notranslate"><span class="pre">r=rad1+rad2</span></code>,  where <code class="docutils literal notranslate"><span class="pre">r1</span></code> and <code class="docutils literal notranslate"><span class="pre">r2</span></code> are the positions of the two balls, <code class="docutils literal notranslate"><span class="pre">v1</span></code> and <code class="docutils literal notranslate"><span class="pre">v2</span></code> are their velocity vectors, and <code class="docutils literal notranslate"><span class="pre">rad1</span></code> and <code class="docutils literal notranslate"><span class="pre">rad2</span></code> are their radii.  Draw some pictures to convince yourself of the geometry.  You can also imagine doing the problem in different frames.  Convince yourself of the answer when one of the balls is stationary and at the origin.  Then shift frames.</p>
<p>We also need to make one change to <code class="docutils literal notranslate"><span class="pre">circ_time</span></code>: if the two balls are closer than <code class="docutils literal notranslate"><span class="pre">rad1+rad2</span></code> you return <code class="docutils literal notranslate"><span class="pre">Inf</span></code>.  That way if round-off error overlaps the balls, it will not cause them to collide on the inside.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Here is my code for this</span>

<span class="k">function</span><span class="w"> </span><span class="n">circ_time</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="w">    </span><span class="c"># Calculate the various terms in our expression</span>
<span class="w">    </span><span class="n">r0dotv</span><span class="o">=</span><span class="n">r0⋅v</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">r0dotv</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="c">#moving away from one another</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">Inf</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">vsq</span><span class="o">=</span><span class="n">v⋅v</span>
<span class="w">    </span><span class="n">r0sq</span><span class="o">=</span><span class="n">r0⋅r0</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">r0sq</span><span class="o">&lt;=</span><span class="n">r</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="c">#balls are interpenetrating</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">Inf</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">discriminant</span><span class="o">=</span><span class="n">r0dotv</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">r</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">r0sq</span><span class="p">)</span><span class="o">*</span><span class="n">vsq</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">discriminant</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="c"># balls will never hit one-another</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">Inf</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">times</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="n">r0dotv</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">vsq</span><span class="p">),(</span><span class="o">-</span><span class="n">r0dotv</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">vsq</span><span class="p">)]</span>
<span class="w">    </span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="o">=</span><span class="n">minmax</span><span class="p">(</span><span class="n">times</span><span class="o">...</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">t2</span><span class="o">&lt;=</span><span class="mi">0</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">Inf</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">t1</span><span class="o">&gt;</span><span class="mi">0</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">t1</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">t2</span>
<span class="k">end</span>

<span class="n">impact_time</span><span class="p">(</span><span class="n">b1</span><span class="o">::</span><span class="kt">Ball</span><span class="p">,</span><span class="n">b2</span><span class="o">::</span><span class="kt">Ball</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span>
<span class="w">    </span><span class="n">t</span><span class="o">+</span><span class="n">circ_time</span><span class="p">(</span><span class="n">get_r</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span><span class="o">-</span><span class="n">get_r</span><span class="p">(</span><span class="n">b2</span><span class="p">),</span>
<span class="w">        </span><span class="n">get_v</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span><span class="o">-</span><span class="n">get_v</span><span class="p">(</span><span class="n">b2</span><span class="p">),</span><span class="n">b1</span><span class="o">.</span><span class="n">radius</span><span class="o">+</span><span class="n">b2</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>impact_time (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<p>Come up with some test cases, to see if this function is behaving properly.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 4
</h2><p>We will now create our event object.  It will simply store the two objects which are involved in the collision, and the time at which the collision will occur.</p>
<p>We will also create our Billiard object, which stores the walls, balls, current time, and the next event.  Lets also store a bounding box there, for visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">abstract</span><span class="w"> </span><span class="k">type</span> <span class="kt">Event</span><span class="w"> </span><span class="k">end</span>

<span class="k">struct</span> <span class="kt">Collision</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Event</span>
<span class="w">    </span><span class="n">object1</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="kt">Union</span><span class="p">{</span><span class="kt">Ball</span><span class="p">,</span><span class="kt">Wall</span><span class="p">}</span>
<span class="w">    </span><span class="n">object2</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="kt">Union</span><span class="p">{</span><span class="kt">Ball</span><span class="p">,</span><span class="kt">Wall</span><span class="p">}</span>
<span class="w">    </span><span class="n">t</span><span class="w">  </span><span class="o">::</span><span class="kt">Float64</span><span class="w">     </span>
<span class="k">end</span>

<span class="k">struct</span> <span class="kt">NullEvent</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Event</span>
<span class="w">    </span><span class="n">t</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="k">end</span>

<span class="n">NE</span><span class="o">=</span><span class="n">NullEvent</span><span class="p">(</span><span class="nb">Inf</span><span class="p">)</span>

<span class="k">mutable</span><span class="w"> </span><span class="k">struct</span> <span class="kt">Billiard</span>
<span class="w">    </span><span class="n">walls</span><span class="w"> </span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Wall</span><span class="p">}</span>
<span class="w">    </span><span class="n">balls</span><span class="w"> </span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Ball</span><span class="p">}</span>
<span class="w">    </span><span class="n">t</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="w">    </span><span class="n">nextevent</span><span class="w"> </span><span class="o">::</span><span class="kt">Event</span>
<span class="w">    </span><span class="n">boundingbox</span><span class="w"> </span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span><span class="c"># x1,y1,x2,y2 = corners of a rectangle</span>
<span class="k">end</span>

<span class="n">Billiard</span><span class="p">(;</span><span class="n">walls</span><span class="p">,</span><span class="n">balls</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">nextevent</span><span class="o">=</span><span class="n">NE</span><span class="p">,</span><span class="n">boundingbox</span><span class="p">)</span><span class="o">=</span>
<span class="w">    </span><span class="n">Billiard</span><span class="p">(</span><span class="n">walls</span><span class="p">,</span><span class="n">balls</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">nextevent</span><span class="p">,</span><span class="n">boundingbox</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Billiard
</pre></div>
</div>
</div>
</div>
<p>Make a function <code class="docutils literal notranslate"><span class="pre">next_event(b::Ball,billiard::Billiard)</span></code>
which will loop through all of the walls and balls in <code class="docutils literal notranslate"><span class="pre">billiard</span></code>, and find their impact time with <code class="docutils literal notranslate"><span class="pre">b</span></code>.  It then finds which collsion will occur next, and create an <code class="docutils literal notranslate"><span class="pre">event</span></code> object corresponding to that collision.</p>
<p>Test with a square billiard containing 2 balls.  Put the balls at various places, and make sure it gives the right answer.</p>
<p>Here is a nice trick for simultaneously looping over walls and balls is to use the <code class="docutils literal notranslate"><span class="pre">union</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">b1</span><span class="o">=</span><span class="n">Ball</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="n">NE</span><span class="p">)</span>
<span class="n">b2</span><span class="o">=</span><span class="n">Ball</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="n">NE</span><span class="p">)</span>

<span class="n">billiard1</span><span class="o">=</span><span class="n">Billiard</span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="p">[</span><span class="n">Hwall</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Vwall</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Hwall</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Vwall</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span class="w">    </span><span class="n">balls</span><span class="o">=</span><span class="p">[</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">],</span><span class="n">boundingbox</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">union</span><span class="p">(</span><span class="n">billiard1</span><span class="o">.</span><span class="n">walls</span><span class="p">,</span><span class="n">billiard1</span><span class="o">.</span><span class="n">balls</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@show</span><span class="w"> </span><span class="n">x</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x = Hwall(1.0)
x = Vwall(1.0)
x = Hwall(-1.0)
x = Vwall(-1.0)
x = Ball(0.0, 0.0, 1.0, 0.0, 0.1, NullEvent(Inf))
x = Ball(0.5, 0.0, -1.0, 0.0, 0.1, NullEvent(Inf))
</pre></div>
</div>
</div>
</div>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 5
</h2><p>To help debug, at this point it is useful to make a <code class="docutils literal notranslate"><span class="pre">visualize</span></code> function, which plots the billiard.  This will differ from the one we did in class in two ways:  (1) we want to plot multiple balls, and (2) we want the balls to have a well defined radius.</p>
<p>Unfortunately, while the <code class="docutils literal notranslate"><span class="pre">Plots.scatter</span></code> command allows us to control the size of the circles, it does so in a slightly complicated way.  It will be better to write our own circle drawing function (or use a different plotting program – I think <code class="docutils literal notranslate"><span class="pre">Makie</span></code> can do a better job)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">drawcircles!</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span><span class="n">radii</span><span class="p">;</span><span class="n">opts</span><span class="o">...</span><span class="p">)</span>
<span class="w">    </span><span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">θ</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">100</span><span class="o">:</span><span class="mi">2</span><span class="nb">pi</span><span class="p">]</span>
<span class="w">    </span><span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">θ</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">100</span><span class="o">:</span><span class="mi">2</span><span class="nb">pi</span><span class="p">]</span>
<span class="w">    </span><span class="n">makecircle</span><span class="p">(</span><span class="n">center</span><span class="p">,</span><span class="n">radius</span><span class="p">)</span><span class="o">=</span><span class="n">Shape</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="n">c</span><span class="o">.+</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">radius</span><span class="o">*</span><span class="n">s</span><span class="o">.+</span><span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="w">    </span><span class="n">circles</span><span class="o">=</span><span class="p">[</span><span class="n">makecircle</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">zip</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span><span class="n">radii</span><span class="p">)]</span>
<span class="w">    </span><span class="n">plot!</span><span class="p">(</span><span class="n">circles</span><span class="p">;</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="ss">:equal</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">opts</span><span class="o">...</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">drawcircles!</span><span class="p">(</span><span class="n">plt</span><span class="o">::</span><span class="kt">Plots</span><span class="o">.</span><span class="n">Plot</span><span class="p">,</span><span class="n">centers</span><span class="p">,</span><span class="n">radii</span><span class="p">;</span><span class="n">opts</span><span class="o">...</span><span class="p">)</span>
<span class="w">    </span><span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">θ</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">100</span><span class="o">:</span><span class="mi">2</span><span class="nb">pi</span><span class="p">]</span>
<span class="w">    </span><span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">θ</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">100</span><span class="o">:</span><span class="mi">2</span><span class="nb">pi</span><span class="p">]</span>
<span class="w">    </span><span class="n">makecircle</span><span class="p">(</span><span class="n">center</span><span class="p">,</span><span class="n">radius</span><span class="p">)</span><span class="o">=</span><span class="n">Shape</span><span class="p">(</span><span class="n">radius</span><span class="o">*</span><span class="n">c</span><span class="o">.+</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">radius</span><span class="o">*</span><span class="n">s</span><span class="o">.+</span><span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="w">    </span><span class="n">circles</span><span class="o">=</span><span class="p">[</span><span class="n">makecircle</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">zip</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span><span class="n">radii</span><span class="p">)]</span>
<span class="w">    </span><span class="n">plot!</span><span class="p">(</span><span class="n">plt</span><span class="p">,</span><span class="n">circles</span><span class="p">;</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="ss">:equal</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">opts</span><span class="o">...</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">drawcircles</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span><span class="n">radii</span><span class="p">;</span><span class="n">opts</span><span class="o">...</span><span class="p">)</span>
<span class="w">    </span><span class="n">plt</span><span class="o">=</span><span class="n">plot</span><span class="p">()</span>
<span class="w">    </span><span class="n">drawcircles!</span><span class="p">(</span><span class="n">plt</span><span class="p">,</span><span class="n">centers</span><span class="p">,</span><span class="n">radii</span><span class="p">;</span><span class="n">opts</span><span class="o">...</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>drawcircles (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">c1</span><span class="o">=</span><span class="n">drawcircles</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]],[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip630">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip630)" d="M0 1600 L2400 1600 L2400 8.88178e-14 L0 8.88178e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip631">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip630)" d="M192.941 1486.45 L2352.76 1486.45 L2352.76 47.2441 L192.941 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip632">
    <rect x="192" y="47" width="2161" height="1440"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="459.498,1486.45 459.498,47.2441 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="918.643,1486.45 918.643,47.2441 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1377.79,1486.45 1377.79,47.2441 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1836.93,1486.45 1836.93,47.2441 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2296.08,1486.45 2296.08,47.2441 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="192.941,1486.45 2352.76,1486.45 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="459.498,1486.45 459.498,1467.55 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="918.643,1486.45 918.643,1467.55 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1377.79,1486.45 1377.79,1467.55 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1836.93,1486.45 1836.93,1467.55 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2296.08,1486.45 2296.08,1467.55 "/>
<path clip-path="url(#clip630)" d="M429.255 1532.02 L458.931 1532.02 L458.931 1535.95 L429.255 1535.95 L429.255 1532.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M469.834 1544.91 L477.473 1544.91 L477.473 1518.55 L469.163 1520.21 L469.163 1515.95 L477.426 1514.29 L482.102 1514.29 L482.102 1544.91 L489.741 1544.91 L489.741 1548.85 L469.834 1548.85 L469.834 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M918.643 1517.37 Q915.032 1517.37 913.203 1520.93 Q911.397 1524.47 911.397 1531.6 Q911.397 1538.71 913.203 1542.27 Q915.032 1545.82 918.643 1545.82 Q922.277 1545.82 924.083 1542.27 Q925.911 1538.71 925.911 1531.6 Q925.911 1524.47 924.083 1520.93 Q922.277 1517.37 918.643 1517.37 M918.643 1513.66 Q924.453 1513.66 927.508 1518.27 Q930.587 1522.85 930.587 1531.6 Q930.587 1540.33 927.508 1544.94 Q924.453 1549.52 918.643 1549.52 Q912.833 1549.52 909.754 1544.94 Q906.698 1540.33 906.698 1531.6 Q906.698 1522.85 909.754 1518.27 Q912.833 1513.66 918.643 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1368.17 1544.91 L1375.81 1544.91 L1375.81 1518.55 L1367.5 1520.21 L1367.5 1515.95 L1375.76 1514.29 L1380.44 1514.29 L1380.44 1544.91 L1388.08 1544.91 L1388.08 1548.85 L1368.17 1548.85 L1368.17 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1831.58 1544.91 L1847.9 1544.91 L1847.9 1548.85 L1825.96 1548.85 L1825.96 1544.91 Q1828.62 1542.16 1833.21 1537.53 Q1837.81 1532.88 1838.99 1531.53 Q1841.24 1529.01 1842.12 1527.27 Q1843.02 1525.51 1843.02 1523.82 Q1843.02 1521.07 1841.08 1519.33 Q1839.15 1517.6 1836.05 1517.6 Q1833.85 1517.6 1831.4 1518.36 Q1828.97 1519.13 1826.19 1520.68 L1826.19 1515.95 Q1829.02 1514.82 1831.47 1514.24 Q1833.92 1513.66 1835.96 1513.66 Q1841.33 1513.66 1844.52 1516.35 Q1847.72 1519.03 1847.72 1523.52 Q1847.72 1525.65 1846.91 1527.57 Q1846.12 1529.47 1844.02 1532.07 Q1843.44 1532.74 1840.33 1535.95 Q1837.23 1539.15 1831.58 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2300.32 1530.21 Q2303.68 1530.93 2305.56 1533.2 Q2307.45 1535.47 2307.45 1538.8 Q2307.45 1543.92 2303.94 1546.72 Q2300.42 1549.52 2293.94 1549.52 Q2291.76 1549.52 2289.44 1549.08 Q2287.15 1548.66 2284.7 1547.81 L2284.7 1543.29 Q2286.64 1544.43 2288.96 1545.01 Q2291.27 1545.58 2293.8 1545.58 Q2298.19 1545.58 2300.49 1543.85 Q2302.8 1542.11 2302.8 1538.8 Q2302.8 1535.75 2300.65 1534.03 Q2298.52 1532.3 2294.7 1532.3 L2290.67 1532.3 L2290.67 1528.45 L2294.88 1528.45 Q2298.33 1528.45 2300.16 1527.09 Q2301.99 1525.7 2301.99 1523.11 Q2301.99 1520.45 2300.09 1519.03 Q2298.22 1517.6 2294.7 1517.6 Q2292.78 1517.6 2290.58 1518.01 Q2288.38 1518.43 2285.74 1519.31 L2285.74 1515.14 Q2288.4 1514.4 2290.72 1514.03 Q2293.06 1513.66 2295.12 1513.66 Q2300.44 1513.66 2303.54 1516.09 Q2306.64 1518.5 2306.64 1522.62 Q2306.64 1525.49 2305 1527.48 Q2303.36 1529.45 2300.32 1530.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="192.941,1350.62 2352.76,1350.62 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="192.941,1121.05 2352.76,1121.05 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="192.941,891.479 2352.76,891.479 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="192.941,661.907 2352.76,661.907 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="192.941,432.335 2352.76,432.335 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="192.941,202.762 2352.76,202.762 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="192.941,1486.45 192.941,47.2441 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="192.941,1350.62 211.838,1350.62 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="192.941,1121.05 211.838,1121.05 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="192.941,891.479 211.838,891.479 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="192.941,661.907 211.838,661.907 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="192.941,432.335 211.838,432.335 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="192.941,202.762 211.838,202.762 "/>
<path clip-path="url(#clip630)" d="M50.9921 1351.08 L80.6679 1351.08 L80.6679 1355.01 L50.9921 1355.01 L50.9921 1351.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M100.76 1336.42 Q97.1493 1336.42 95.3206 1339.99 Q93.515 1343.53 93.515 1350.66 Q93.515 1357.76 95.3206 1361.33 Q97.1493 1364.87 100.76 1364.87 Q104.395 1364.87 106.2 1361.33 Q108.029 1357.76 108.029 1350.66 Q108.029 1343.53 106.2 1339.99 Q104.395 1336.42 100.76 1336.42 M100.76 1332.72 Q106.571 1332.72 109.626 1337.33 Q112.705 1341.91 112.705 1350.66 Q112.705 1359.39 109.626 1363.99 Q106.571 1368.58 100.76 1368.58 Q94.9502 1368.58 91.8715 1363.99 Q88.816 1359.39 88.816 1350.66 Q88.816 1341.91 91.8715 1337.33 Q94.9502 1332.72 100.76 1332.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M120.922 1362.02 L125.807 1362.02 L125.807 1367.9 L120.922 1367.9 L120.922 1362.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M136.038 1333.34 L154.394 1333.34 L154.394 1337.28 L140.32 1337.28 L140.32 1345.75 Q141.339 1345.4 142.357 1345.24 Q143.376 1345.06 144.394 1345.06 Q150.181 1345.06 153.561 1348.23 Q156.941 1351.4 156.941 1356.82 Q156.941 1362.39 153.468 1365.5 Q149.996 1368.58 143.677 1368.58 Q141.501 1368.58 139.232 1368.2 Q136.987 1367.83 134.58 1367.09 L134.58 1362.39 Q136.663 1363.53 138.885 1364.08 Q141.107 1364.64 143.584 1364.64 Q147.589 1364.64 149.927 1362.53 Q152.265 1360.43 152.265 1356.82 Q152.265 1353.2 149.927 1351.1 Q147.589 1348.99 143.584 1348.99 Q141.709 1348.99 139.834 1349.41 Q137.982 1349.83 136.038 1350.7 L136.038 1333.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M99.765 1106.85 Q96.1539 1106.85 94.3252 1110.41 Q92.5197 1113.96 92.5197 1121.09 Q92.5197 1128.19 94.3252 1131.76 Q96.1539 1135.3 99.765 1135.3 Q103.399 1135.3 105.205 1131.76 Q107.033 1128.19 107.033 1121.09 Q107.033 1113.96 105.205 1110.41 Q103.399 1106.85 99.765 1106.85 M99.765 1103.15 Q105.575 1103.15 108.631 1107.75 Q111.709 1112.34 111.709 1121.09 Q111.709 1129.81 108.631 1134.42 Q105.575 1139 99.765 1139 Q93.9549 1139 90.8762 1134.42 Q87.8206 1129.81 87.8206 1121.09 Q87.8206 1112.34 90.8762 1107.75 Q93.9549 1103.15 99.765 1103.15 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M119.927 1132.45 L124.811 1132.45 L124.811 1138.33 L119.927 1138.33 L119.927 1132.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M144.996 1106.85 Q141.385 1106.85 139.556 1110.41 Q137.751 1113.96 137.751 1121.09 Q137.751 1128.19 139.556 1131.76 Q141.385 1135.3 144.996 1135.3 Q148.63 1135.3 150.436 1131.76 Q152.265 1128.19 152.265 1121.09 Q152.265 1113.96 150.436 1110.41 Q148.63 1106.85 144.996 1106.85 M144.996 1103.15 Q150.806 1103.15 153.862 1107.75 Q156.941 1112.34 156.941 1121.09 Q156.941 1129.81 153.862 1134.42 Q150.806 1139 144.996 1139 Q139.186 1139 136.107 1134.42 Q133.052 1129.81 133.052 1121.09 Q133.052 1112.34 136.107 1107.75 Q139.186 1103.15 144.996 1103.15 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M100.76 877.278 Q97.1493 877.278 95.3206 880.843 Q93.515 884.384 93.515 891.514 Q93.515 898.62 95.3206 902.185 Q97.1493 905.727 100.76 905.727 Q104.395 905.727 106.2 902.185 Q108.029 898.62 108.029 891.514 Q108.029 884.384 106.2 880.843 Q104.395 877.278 100.76 877.278 M100.76 873.574 Q106.571 873.574 109.626 878.181 Q112.705 882.764 112.705 891.514 Q112.705 900.241 109.626 904.847 Q106.571 909.431 100.76 909.431 Q94.9502 909.431 91.8715 904.847 Q88.816 900.241 88.816 891.514 Q88.816 882.764 91.8715 878.181 Q94.9502 873.574 100.76 873.574 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M120.922 902.88 L125.807 902.88 L125.807 908.759 L120.922 908.759 L120.922 902.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M136.038 874.199 L154.394 874.199 L154.394 878.134 L140.32 878.134 L140.32 886.607 Q141.339 886.259 142.357 886.097 Q143.376 885.912 144.394 885.912 Q150.181 885.912 153.561 889.083 Q156.941 892.255 156.941 897.671 Q156.941 903.25 153.468 906.352 Q149.996 909.431 143.677 909.431 Q141.501 909.431 139.232 909.06 Q136.987 908.69 134.58 907.949 L134.58 903.25 Q136.663 904.384 138.885 904.94 Q141.107 905.495 143.584 905.495 Q147.589 905.495 149.927 903.389 Q152.265 901.282 152.265 897.671 Q152.265 894.06 149.927 891.954 Q147.589 889.847 143.584 889.847 Q141.709 889.847 139.834 890.264 Q137.982 890.681 136.038 891.56 L136.038 874.199 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M90.5752 675.252 L98.2141 675.252 L98.2141 648.886 L89.904 650.553 L89.904 646.294 L98.1678 644.627 L102.844 644.627 L102.844 675.252 L110.483 675.252 L110.483 679.187 L90.5752 679.187 L90.5752 675.252 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M119.927 673.307 L124.811 673.307 L124.811 679.187 L119.927 679.187 L119.927 673.307 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M144.996 647.706 Q141.385 647.706 139.556 651.27 Q137.751 654.812 137.751 661.942 Q137.751 669.048 139.556 672.613 Q141.385 676.155 144.996 676.155 Q148.63 676.155 150.436 672.613 Q152.265 669.048 152.265 661.942 Q152.265 654.812 150.436 651.27 Q148.63 647.706 144.996 647.706 M144.996 644.002 Q150.806 644.002 153.862 648.608 Q156.941 653.192 156.941 661.942 Q156.941 670.668 153.862 675.275 Q150.806 679.858 144.996 679.858 Q139.186 679.858 136.107 675.275 Q133.052 670.668 133.052 661.942 Q133.052 653.192 136.107 648.608 Q139.186 644.002 144.996 644.002 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M91.5706 445.68 L99.2095 445.68 L99.2095 419.314 L90.8993 420.981 L90.8993 416.721 L99.1632 415.055 L103.839 415.055 L103.839 445.68 L111.478 445.68 L111.478 449.615 L91.5706 449.615 L91.5706 445.68 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M120.922 443.735 L125.807 443.735 L125.807 449.615 L120.922 449.615 L120.922 443.735 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M136.038 415.055 L154.394 415.055 L154.394 418.99 L140.32 418.99 L140.32 427.462 Q141.339 427.115 142.357 426.953 Q143.376 426.768 144.394 426.768 Q150.181 426.768 153.561 429.939 Q156.941 433.11 156.941 438.527 Q156.941 444.105 153.468 447.207 Q149.996 450.286 143.677 450.286 Q141.501 450.286 139.232 449.916 Q136.987 449.545 134.58 448.804 L134.58 444.105 Q136.663 445.24 138.885 445.795 Q141.107 446.351 143.584 446.351 Q147.589 446.351 149.927 444.244 Q152.265 442.138 152.265 438.527 Q152.265 434.916 149.927 432.809 Q147.589 430.703 143.584 430.703 Q141.709 430.703 139.834 431.119 Q137.982 431.536 136.038 432.416 L136.038 415.055 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M93.7928 216.107 L110.112 216.107 L110.112 220.042 L88.1679 220.042 L88.1679 216.107 Q90.8299 213.353 95.4132 208.723 Q100.02 204.07 101.2 202.728 Q103.446 200.205 104.325 198.468 Q105.228 196.709 105.228 195.019 Q105.228 192.265 103.284 190.529 Q101.362 188.793 98.2604 188.793 Q96.0613 188.793 93.6076 189.556 Q91.1771 190.32 88.3993 191.871 L88.3993 187.149 Q91.2234 186.015 93.6771 185.436 Q96.1308 184.857 98.1678 184.857 Q103.538 184.857 106.733 187.543 Q109.927 190.228 109.927 194.718 Q109.927 196.848 109.117 198.769 Q108.33 200.668 106.223 203.26 Q105.645 203.931 102.543 207.149 Q99.4409 210.343 93.7928 216.107 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M119.927 214.163 L124.811 214.163 L124.811 220.042 L119.927 220.042 L119.927 214.163 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M144.996 188.561 Q141.385 188.561 139.556 192.126 Q137.751 195.668 137.751 202.797 Q137.751 209.904 139.556 213.468 Q141.385 217.01 144.996 217.01 Q148.63 217.01 150.436 213.468 Q152.265 209.904 152.265 202.797 Q152.265 195.668 150.436 192.126 Q148.63 188.561 144.996 188.561 M144.996 184.857 Q150.806 184.857 153.862 189.464 Q156.941 194.047 156.941 202.797 Q156.941 211.524 153.862 216.13 Q150.806 220.714 144.996 220.714 Q139.186 220.714 136.107 216.13 Q133.052 211.524 133.052 202.797 Q133.052 194.047 136.107 189.464 Q139.186 184.857 144.996 184.857 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip632)" d="M1243.31 1121.05 L1242.67 1100.67 L1240.75 1080.36 L1237.56 1060.22 L1233.11 1040.31 L1227.42 1020.72 L1220.51 1001.53 L1212.41 982.816 L1203.15 964.643 L1192.77 947.088 L1181.3 930.219 L1168.8 914.103 L1155.31 898.804 L1140.89 884.381 L1125.59 870.893 L1109.48 858.393 L1092.61 846.928 L1075.05 836.546 L1056.88 827.287 L1038.16 819.186 L1018.97 812.277 L999.383 806.587 L979.479 802.138 L959.334 798.947 L939.029 797.028 L918.643 796.387 L898.257 797.028 L877.952 798.947 L857.807 802.138 L837.902 806.587 L818.316 812.277 L799.126 819.186 L780.407 827.287 L762.235 836.546 L744.679 846.928 L727.81 858.393 L711.694 870.893 L696.395 884.381 L681.973 898.804 L668.485 914.103 L655.984 930.219 L644.52 947.088 L634.137 964.643 L624.878 982.816 L616.778 1001.53 L609.869 1020.72 L604.178 1040.31 L599.729 1060.22 L596.539 1080.36 L594.619 1100.67 L593.979 1121.05 L594.619 1141.44 L596.539 1161.74 L599.729 1181.89 L604.178 1201.79 L609.869 1221.38 L616.778 1240.57 L624.878 1259.29 L634.137 1277.46 L644.52 1295.02 L655.984 1311.88 L668.485 1328 L681.973 1343.3 L696.395 1357.72 L711.694 1371.21 L727.81 1383.71 L744.679 1395.17 L762.235 1405.56 L780.407 1414.82 L799.126 1422.92 L818.316 1429.83 L837.902 1435.52 L857.807 1439.96 L877.952 1443.16 L898.257 1445.08 L918.643 1445.72 L939.029 1445.08 L959.334 1443.16 L979.479 1439.96 L999.383 1435.52 L1018.97 1429.83 L1038.16 1422.92 L1056.88 1414.82 L1075.05 1405.56 L1092.61 1395.17 L1109.48 1383.71 L1125.59 1371.21 L1140.89 1357.72 L1155.31 1343.3 L1168.8 1328 L1181.3 1311.88 L1192.77 1295.02 L1203.15 1277.46 L1212.41 1259.29 L1220.51 1240.57 L1227.42 1221.38 L1233.11 1201.79 L1237.56 1181.89 L1240.75 1161.74 L1242.67 1141.44 L1243.31 1121.05  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1243.31,1121.05 1242.67,1100.67 1240.75,1080.36 1237.56,1060.22 1233.11,1040.31 1227.42,1020.72 1220.51,1001.53 1212.41,982.816 1203.15,964.643 1192.77,947.088 1181.3,930.219 1168.8,914.103 1155.31,898.804 1140.89,884.381 1125.59,870.893 1109.48,858.393 1092.61,846.928 1075.05,836.546 1056.88,827.287 1038.16,819.186 1018.97,812.277 999.383,806.587 979.479,802.138 959.334,798.947 939.029,797.028 918.643,796.387 898.257,797.028 877.952,798.947 857.807,802.138 837.902,806.587 818.316,812.277 799.126,819.186 780.407,827.287 762.235,836.546 744.679,846.928 727.81,858.393 711.694,870.893 696.395,884.381 681.973,898.804 668.485,914.103 655.984,930.219 644.52,947.088 634.137,964.643 624.878,982.816 616.778,1001.53 609.869,1020.72 604.178,1040.31 599.729,1060.22 596.539,1080.36 594.619,1100.67 593.979,1121.05 594.619,1141.44 596.539,1161.74 599.729,1181.89 604.178,1201.79 609.869,1221.38 616.778,1240.57 624.878,1259.29 634.137,1277.46 644.52,1295.02 655.984,1311.88 668.485,1328 681.973,1343.3 696.395,1357.72 711.694,1371.21 727.81,1383.71 744.679,1395.17 762.235,1405.56 780.407,1414.82 799.126,1422.92 818.316,1429.83 837.902,1435.52 857.807,1439.96 877.952,1443.16 898.257,1445.08 918.643,1445.72 939.029,1445.08 959.334,1443.16 979.479,1439.96 999.383,1435.52 1018.97,1429.83 1038.16,1422.92 1056.88,1414.82 1075.05,1405.56 1092.61,1395.17 1109.48,1383.71 1125.59,1371.21 1140.89,1357.72 1155.31,1343.3 1168.8,1328 1181.3,1311.88 1192.77,1295.02 1203.15,1277.46 1212.41,1259.29 1220.51,1240.57 1227.42,1221.38 1233.11,1201.79 1237.56,1181.89 1240.75,1161.74 1242.67,1141.44 1243.31,1121.05 "/>
<path clip-path="url(#clip632)" d="M1702.45 661.907 L1701.81 641.521 L1699.89 621.216 L1696.7 601.071 L1692.25 581.166 L1686.56 561.58 L1679.65 542.39 L1671.55 523.672 L1662.29 505.499 L1651.91 487.943 L1640.45 471.074 L1627.95 454.958 L1614.46 439.659 L1600.04 425.237 L1584.74 411.749 L1568.62 399.248 L1551.75 387.784 L1534.2 377.402 L1516.02 368.142 L1497.3 360.042 L1478.11 353.133 L1458.53 347.443 L1438.62 342.993 L1418.48 339.803 L1398.17 337.883 L1377.79 337.243 L1357.4 337.883 L1337.1 339.803 L1316.95 342.993 L1297.05 347.443 L1277.46 353.133 L1258.27 360.042 L1239.55 368.142 L1221.38 377.402 L1203.82 387.784 L1186.95 399.248 L1170.84 411.749 L1155.54 425.237 L1141.12 439.659 L1127.63 454.958 L1115.13 471.074 L1103.66 487.943 L1093.28 505.499 L1084.02 523.672 L1075.92 542.39 L1069.01 561.58 L1063.32 581.166 L1058.87 601.071 L1055.68 621.216 L1053.76 641.521 L1053.12 661.907 L1053.76 682.293 L1055.68 702.598 L1058.87 722.743 L1063.32 742.648 L1069.01 762.234 L1075.92 781.424 L1084.02 800.142 L1093.28 818.315 L1103.66 835.871 L1115.13 852.74 L1127.63 868.856 L1141.12 884.155 L1155.54 898.577 L1170.84 912.065 L1186.95 924.566 L1203.82 936.03 L1221.38 946.412 L1239.55 955.672 L1258.27 963.772 L1277.46 970.681 L1297.05 976.371 L1316.95 980.82 L1337.1 984.011 L1357.4 985.931 L1377.79 986.571 L1398.17 985.931 L1418.48 984.011 L1438.62 980.82 L1458.53 976.371 L1478.11 970.681 L1497.3 963.772 L1516.02 955.672 L1534.2 946.412 L1551.75 936.03 L1568.62 924.566 L1584.74 912.065 L1600.04 898.577 L1614.46 884.155 L1627.95 868.856 L1640.45 852.74 L1651.91 835.871 L1662.29 818.315 L1671.55 800.142 L1679.65 781.424 L1686.56 762.234 L1692.25 742.648 L1696.7 722.743 L1699.89 702.598 L1701.81 682.293 L1702.45 661.907  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1702.45,661.907 1701.81,641.521 1699.89,621.216 1696.7,601.071 1692.25,581.166 1686.56,561.58 1679.65,542.39 1671.55,523.672 1662.29,505.499 1651.91,487.943 1640.45,471.074 1627.95,454.958 1614.46,439.659 1600.04,425.237 1584.74,411.749 1568.62,399.248 1551.75,387.784 1534.2,377.402 1516.02,368.142 1497.3,360.042 1478.11,353.133 1458.53,347.443 1438.62,342.993 1418.48,339.803 1398.17,337.883 1377.79,337.243 1357.4,337.883 1337.1,339.803 1316.95,342.993 1297.05,347.443 1277.46,353.133 1258.27,360.042 1239.55,368.142 1221.38,377.402 1203.82,387.784 1186.95,399.248 1170.84,411.749 1155.54,425.237 1141.12,439.659 1127.63,454.958 1115.13,471.074 1103.66,487.943 1093.28,505.499 1084.02,523.672 1075.92,542.39 1069.01,561.58 1063.32,581.166 1058.87,601.071 1055.68,621.216 1053.76,641.521 1053.12,661.907 1053.76,682.293 1055.68,702.598 1058.87,722.743 1063.32,742.648 1069.01,762.234 1075.92,781.424 1084.02,800.142 1093.28,818.315 1103.66,835.871 1115.13,852.74 1127.63,868.856 1141.12,884.155 1155.54,898.577 1170.84,912.065 1186.95,924.566 1203.82,936.03 1221.38,946.412 1239.55,955.672 1258.27,963.772 1277.46,970.681 1297.05,976.371 1316.95,980.82 1337.1,984.011 1357.4,985.931 1377.79,986.571 1398.17,985.931 1418.48,984.011 1438.62,980.82 1458.53,976.371 1478.11,970.681 1497.3,963.772 1516.02,955.672 1534.2,946.412 1551.75,936.03 1568.62,924.566 1584.74,912.065 1600.04,898.577 1614.46,884.155 1627.95,868.856 1640.45,852.74 1651.91,835.871 1662.29,818.315 1671.55,800.142 1679.65,781.424 1686.56,762.234 1692.25,742.648 1696.7,722.743 1699.89,702.598 1701.81,682.293 1702.45,661.907 "/>
<path clip-path="url(#clip632)" d="M1951.72 202.762 L1951.49 195.555 L1950.81 188.376 L1949.68 181.254 L1948.11 174.216 L1946.1 167.292 L1943.66 160.507 L1940.79 153.889 L1937.52 147.464 L1933.85 141.257 L1929.8 135.293 L1925.38 129.595 L1920.61 124.186 L1915.51 119.087 L1910.1 114.318 L1904.4 109.898 L1898.44 105.845 L1892.23 102.175 L1885.81 98.9008 L1879.19 96.037 L1872.4 93.5943 L1865.48 91.5825 L1858.44 90.0095 L1851.32 88.8814 L1844.14 88.2028 L1836.93 87.9763 L1829.72 88.2028 L1822.55 88.8814 L1815.42 90.0095 L1808.39 91.5825 L1801.46 93.5943 L1794.68 96.037 L1788.06 98.9008 L1781.63 102.175 L1775.43 105.845 L1769.46 109.898 L1763.76 114.318 L1758.36 119.087 L1753.26 124.186 L1748.49 129.595 L1744.07 135.293 L1740.01 141.257 L1736.34 147.464 L1733.07 153.889 L1730.21 160.507 L1727.76 167.292 L1725.75 174.216 L1724.18 181.254 L1723.05 188.376 L1722.37 195.555 L1722.15 202.762 L1722.37 209.97 L1723.05 217.149 L1724.18 224.271 L1725.75 231.309 L1727.76 238.233 L1730.21 245.018 L1733.07 251.636 L1736.34 258.061 L1740.01 264.268 L1744.07 270.232 L1748.49 275.93 L1753.26 281.339 L1758.36 286.438 L1763.76 291.207 L1769.46 295.626 L1775.43 299.68 L1781.63 303.35 L1788.06 306.624 L1794.68 309.488 L1801.46 311.931 L1808.39 313.942 L1815.42 315.515 L1822.55 316.643 L1829.72 317.322 L1836.93 317.549 L1844.14 317.322 L1851.32 316.643 L1858.44 315.515 L1865.48 313.942 L1872.4 311.931 L1879.19 309.488 L1885.81 306.624 L1892.23 303.35 L1898.44 299.68 L1904.4 295.626 L1910.1 291.207 L1915.51 286.438 L1920.61 281.339 L1925.38 275.93 L1929.8 270.232 L1933.85 264.268 L1937.52 258.061 L1940.79 251.636 L1943.66 245.018 L1946.1 238.233 L1948.11 231.309 L1949.68 224.271 L1950.81 217.149 L1951.49 209.97 L1951.72 202.762  Z" fill="#3da44d" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1951.72,202.762 1951.49,195.555 1950.81,188.376 1949.68,181.254 1948.11,174.216 1946.1,167.292 1943.66,160.507 1940.79,153.889 1937.52,147.464 1933.85,141.257 1929.8,135.293 1925.38,129.595 1920.61,124.186 1915.51,119.087 1910.1,114.318 1904.4,109.898 1898.44,105.845 1892.23,102.175 1885.81,98.9008 1879.19,96.037 1872.4,93.5943 1865.48,91.5825 1858.44,90.0095 1851.32,88.8814 1844.14,88.2028 1836.93,87.9763 1829.72,88.2028 1822.55,88.8814 1815.42,90.0095 1808.39,91.5825 1801.46,93.5943 1794.68,96.037 1788.06,98.9008 1781.63,102.175 1775.43,105.845 1769.46,109.898 1763.76,114.318 1758.36,119.087 1753.26,124.186 1748.49,129.595 1744.07,135.293 1740.01,141.257 1736.34,147.464 1733.07,153.889 1730.21,160.507 1727.76,167.292 1725.75,174.216 1724.18,181.254 1723.05,188.376 1722.37,195.555 1722.15,202.762 1722.37,209.97 1723.05,217.149 1724.18,224.271 1725.75,231.309 1727.76,238.233 1730.21,245.018 1733.07,251.636 1736.34,258.061 1740.01,264.268 1744.07,270.232 1748.49,275.93 1753.26,281.339 1758.36,286.438 1763.76,291.207 1769.46,295.626 1775.43,299.68 1781.63,303.35 1788.06,306.624 1794.68,309.488 1801.46,311.931 1808.39,313.942 1815.42,315.515 1822.55,316.643 1829.72,317.322 1836.93,317.549 1844.14,317.322 1851.32,316.643 1858.44,315.515 1865.48,313.942 1872.4,311.931 1879.19,309.488 1885.81,306.624 1892.23,303.35 1898.44,299.68 1904.4,295.626 1910.1,291.207 1915.51,286.438 1920.61,281.339 1925.38,275.93 1929.8,270.232 1933.85,264.268 1937.52,258.061 1940.79,251.636 1943.66,245.018 1946.1,238.233 1948.11,231.309 1949.68,224.271 1950.81,217.149 1951.49,209.97 1951.72,202.762 "/>
</svg>
</div></div>
</div>
<p>Use this command to write a <code class="docutils literal notranslate"><span class="pre">visualize(billiard::Billiard)</span></code> function which draws the current state of a billiard.  Test.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 5
</h2><p>Write a function <code class="docutils literal notranslate"><span class="pre">setevents!(billiard::Billiard)</span></code> – which will loop over all the <code class="docutils literal notranslate"><span class="pre">Balls</span></code>, setting their <code class="docutils literal notranslate"><span class="pre">nextevent</span></code> attribute to the output of <code class="docutils literal notranslate"><span class="pre">next_event</span></code>.  Note that for <span class="math notranslate nohighlight">\(N\)</span> balls, this take of order <span class="math notranslate nohighlight">\(O(N^2)\)</span> time.</p>
<p>As you go, update <code class="docutils literal notranslate"><span class="pre">billiard.nextevent</span></code> with the earliest of these.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">billiard1</span><span class="o">.</span><span class="n">nextevent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NullEvent(Inf)
</pre></div>
</div>
</div>
</div>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 6
</h2><p>We already have code for when a ball bounces off of a wall:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">reflect</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span><span class="n">normal</span><span class="p">)</span><span class="o">=</span><span class="n">vec</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">vec⋅normal</span><span class="p">)</span><span class="o">*</span><span class="n">normal</span><span class="o">/</span><span class="p">(</span><span class="n">normal⋅normal</span><span class="p">)</span>
<span class="n">normal</span><span class="p">(</span><span class="n">w</span><span class="o">::</span><span class="kt">Hwall</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">normal</span><span class="p">(</span><span class="n">w</span><span class="o">::</span><span class="kt">Vwall</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="k">function</span><span class="w"> </span><span class="n">newvelocity</span><span class="p">(</span><span class="n">w</span><span class="o">::</span><span class="kt">Wall</span><span class="p">,</span><span class="n">b</span><span class="o">::</span><span class="kt">Ball</span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="o">=</span><span class="n">get_r</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="o">=</span><span class="n">normal</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="w">    </span><span class="n">v</span><span class="o">=</span><span class="n">get_v</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">reflect</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">set_newvelocity!</span><span class="p">(</span><span class="n">w</span><span class="o">::</span><span class="kt">Wall</span><span class="p">,</span><span class="n">b</span><span class="o">::</span><span class="kt">Ball</span><span class="p">)</span>
<span class="w">    </span><span class="n">v</span><span class="o">=</span><span class="n">newvelocity</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="w">    </span><span class="n">set_v!</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">b</span>
<span class="k">end</span>

<span class="n">set_newvelocity!</span><span class="p">(</span><span class="n">b</span><span class="o">::</span><span class="kt">Ball</span><span class="p">,</span><span class="n">w</span><span class="o">::</span><span class="kt">Wall</span><span class="p">)</span><span class="o">=</span><span class="n">set_newvelocity!</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>set_newvelocity! (generic function with 2 methods)
</pre></div>
</div>
</div>
</div>
<p>We need similar code for when two balls bounce off of one-another.  Write a function <code class="docutils literal notranslate"><span class="pre">set_newvelocity!(b1::Ball,b1::ball)</span></code> which sets the velocities of two colliding balls after a collision.  Assume that the balls are in physical contact (so you dont’ need to check if they will collide, or find their positions at that time – we will only call this function when they are at the right locations).</p>
<p>Hint:  In the center of mass frame, the velocities are just reflected using the normal vector at the collision point.  We will assume all of the balls have the same mass, so the center of mass frame is easy to find</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 7
</h2><p>Make a method <code class="docutils literal notranslate"><span class="pre">update!(billiard::Billiard,event::Event)</span></code>, which grabs <code class="docutils literal notranslate"><span class="pre">current_time=billiard.t</span></code> and <code class="docutils literal notranslate"><span class="pre">collision_time=event.t</span></code>.  It updates the positions of the balls as they move in a straight line path between those times.  (for that you might want to make a <code class="docutils literal notranslate"><span class="pre">time_evolve(b:Ball,dt)</span></code> method.  Your <code class="docutils literal notranslate"><span class="pre">update!</span></code> method should then calls <code class="docutils literal notranslate"><span class="pre">set_newvelocity!</span></code> on the objects in the event.  Finally it should update <code class="docutils literal notranslate"><span class="pre">billiard.t</span></code>.</p>
<p>A good way to test this is to first generate a <code class="docutils literal notranslate"><span class="pre">Billiard</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>b1=Ball(0,0,1,0,0.1,NE)
b2=Ball(0.5,0.,-1,0,0.1,NE)
billiard1=Billiard(walls=[Hwall(1),Vwall(1),Hwall(-1),Vwall(-1)],
    balls=[b1,b2],boundingbox=[-1,-1,1,1])
visualize(billiard1)
</pre></div>
</div>
<p>Run that, then in a new cell run</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>setevents!(billiard1)
update!(billiard1,billiard1.nextevent)
visualize(billiard1)
</pre></div>
</div>
<p>Every time you run that cell it should update the billiard, and the visualization.  Do that a bunch of times to see if it is acting correctly.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 8
</h2><p>Now you have all the ingredients that you need for the simulation.  We need to figure out, however, how we will deliver the output.  Lets use the following data structure</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="kt">State</span>
<span class="w">    </span><span class="n">xvalues</span><span class="w"> </span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span>
<span class="w">    </span><span class="n">yvalues</span><span class="w"> </span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span>
<span class="w">    </span><span class="n">vxvalues</span><span class="w"> </span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span>
<span class="w">    </span><span class="n">vyvalues</span><span class="w"> </span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span>
<span class="w">    </span><span class="n">radii</span><span class="w"> </span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span>
<span class="w">    </span><span class="n">t</span><span class="w"> </span><span class="o">::</span><span class="kt">Float64</span>
<span class="k">end</span>

<span class="k">struct</span> <span class="kt">Simulationdata</span>
<span class="w">    </span><span class="n">walls</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="kt">Array</span><span class="p">{</span><span class="kt">Wall</span><span class="p">}</span>
<span class="w">    </span><span class="n">statelist</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="kt">Array</span><span class="p">{</span><span class="kt">State</span><span class="p">}</span>
<span class="w">    </span><span class="n">boundingbox</span><span class="w"> </span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span>
<span class="k">end</span>

<span class="n">Base</span><span class="o">.</span><span class="n">length</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">Simulationdata</span><span class="p">)</span><span class="o">=</span><span class="n">length</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">statelist</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The object <code class="docutils literal notranslate"><span class="pre">State</span></code> will contain the x,y,vx,yv for each of the balls in the current state of the system.</p>
<p>Write a function which creates a state object from a Billiard</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>function State(b::Billiard)
    ...
end
</pre></div>
</div>
<p>Also make a function which can be used to visualizes a state:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>function visualize!(plt::Plots.Plot,s::State;opts...)
</pre></div>
</div>
<p>test the state creation and visualization.  Note, this <code class="docutils literal notranslate"><span class="pre">visualize</span></code> should only draw the balls – you will separately draw the walls.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 9
</h2><p>Make your main loop</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>function simulate(billiard::Billiard,n)
</pre></div>
</div>
<p>that takes a <code class="docutils literal notranslate"><span class="pre">Billiard</span></code>, and time-evolves it for a fixed number of collisions.  It then returns the a <code class="docutils literal notranslate"><span class="pre">Simulationdata</span></code> object.</p>
<p>Test with a small run with a couple balls, and just a few collisions.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 10
</h2><p>Now we need some visualization. The first thing we need is a function which draws the configuration for a single frame of our simulation data, something like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">drawframe</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">Simulationdata</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<span class="w">    </span><span class="n">walls</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">walls</span>
<span class="w">    </span><span class="n">bbox</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">boundingbox</span>
<span class="w">    </span><span class="n">plt</span><span class="o">=</span><span class="n">plot</span><span class="p">()</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">walls</span>
<span class="w">        </span><span class="n">visualize!</span><span class="p">(</span><span class="n">plt</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">bbox</span><span class="p">;</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">visualize!</span><span class="p">(</span><span class="n">plt</span><span class="p">,</span><span class="n">s</span><span class="o">.</span><span class="n">statelist</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>drawframe (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<p>Test to see if this works by running your <code class="docutils literal notranslate"><span class="pre">simulate</span></code> function for a few collisions, and draw some of the resulting configurations</p>
<p>Now here is a minimal implementation of a <code class="docutils literal notranslate"><span class="pre">eventanimate</span></code> function.  Here <code class="docutils literal notranslate"><span class="pre">skip</span></code> is an integer which lets us skip frames to speed up the animation when we have lots of balls</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">eventanimate</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">Simulationdata</span><span class="p">,</span><span class="n">skip</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="c"># print out a message to let the user know things are starting</span>
<span class="w">    </span><span class="nd">@info</span><span class="w"> </span><span class="s">&quot;Animating Simulation&quot;</span>
<span class="w">    </span><span class="n">len</span><span class="o">=</span><span class="n">length</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="w">    </span><span class="n">progress_meter</span><span class="o">=</span><span class="n">Progress</span><span class="p">(</span><span class="n">len</span><span class="p">,</span><span class="n">desc</span><span class="o">=</span><span class="s">&quot;Generating frames: &quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">anim</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nd">@animate</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">skip</span><span class="o">:</span><span class="n">len</span>
<span class="w">        </span><span class="n">ProgressMeter</span><span class="o">.</span><span class="n">update!</span><span class="p">(</span><span class="n">progress_meter</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="n">drawframe</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">Plots</span><span class="o">.</span><span class="n">gif</span><span class="p">(</span><span class="n">anim</span><span class="p">,</span><span class="w"> </span><span class="n">fps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eventanimate (generic function with 2 methods)
</pre></div>
</div>
</div>
</div>
<p>Test it out with just a couple balls.  It should be pretty jumpy, but that is OK – we are going to want to work with many balls, which will smooth it out.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 11
</h2><p>Now we need to automate initial conditions.  For simplicity, lets start the balls on a <span class="math notranslate nohighlight">\(n_x\times n_y\)</span> grid (so there will be <span class="math notranslate nohighlight">\(N=n_x n_y\)</span> balls).  We will give each of them speed 1, with a velocity vector pointing in a random direction.</p>
<p>Make a function that takes the <span class="math notranslate nohighlight">\(n_x\)</span>, <span class="math notranslate nohighlight">\(n_y\)</span>, the radii of the balls, and the dimensions of the Billiard.  It should then produce the desired configuration.</p>
<p>Test it with <span class="math notranslate nohighlight">\(L_x=L_y=1\)</span>,  <span class="math notranslate nohighlight">\(n_x=n_y=10\)</span>, and use a radius of <span class="math notranslate nohighlight">\(0.01\)</span>.  For me running a simulation with 100 collisions took about 0.2s. Use <code class="docutils literal notranslate"><span class="pre">&#64;time</span></code> to see how long it takes you.</p>
<p>Look at individual frames (using <code class="docutils literal notranslate"><span class="pre">drawframe</span></code>).  If all is good, then make an animation.  If the animation runs too slow, use the <code class="docutils literal notranslate"><span class="pre">skip</span></code> argument in <code class="docutils literal notranslate"><span class="pre">eventanimate</span></code>.</p>
<p>To get a uniformly distributed random number you can use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Random</span>
<span class="n">rand</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.650364167657448
</pre></div>
</div>
</div>
</div>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 12
</h2><p>We now want to make things faster.  100 collisions in 0.2s is too slow for me.  We are going to want to do many thousands of collisions.</p>
<p>The biggest algorithmic bottleneck is that in every step we update the collisions for every single ball.</p>
<p>The current code should look something like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>function setevents!(billiard::Billiard)
    t_global=Inf
    for b in billiard.balls
        next=next_event(b,billiard)
        b.nextevent=next
        if next.t&lt;t_global
            t_global=next.t
            billiard.nextevent=next
        end
    end
    return billiard
end
</pre></div>
</div>
<p>We are looping through every single ball, and calculating its collision time with every other ball, using the <code class="docutils literal notranslate"><span class="pre">next_event</span></code> method.  This is wasteful: we only need to calculate times with the balls in the last event.</p>
<p>We want to make a new version of <code class="docutils literal notranslate"><span class="pre">setevents!</span></code>, that is called with the billiard, and the last event, and then only updates the things which we know might have changed:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>function setevents!(billiard::Billiard,lastevent::Collision)
</pre></div>
</div>
<p>Here is the algorithm:</p>
<p>The first thing we do is make a list of all the <code class="docutils literal notranslate"><span class="pre">Ball</span></code> objects in <code class="docutils literal notranslate"><span class="pre">lastevent</span></code>.  Suppose there is just one of them – lets call it <code class="docutils literal notranslate"><span class="pre">b0</span></code>.  We set <code class="docutils literal notranslate"><span class="pre">b0.nextevent</span></code> to be equal to the null event <code class="docutils literal notranslate"><span class="pre">NE</span></code>.  We also set <code class="docutils literal notranslate"><span class="pre">billiard.nextevent</span></code> to the null event.</p>
<p>We will then loop through all of the balls in billiard.  For each ball <code class="docutils literal notranslate"><span class="pre">bj</span></code> we calculate the next collision time between <code class="docutils literal notranslate"><span class="pre">b0</span></code> and <code class="docutils literal notranslate"><span class="pre">bj</span></code>.  If that collision time is shorter than <code class="docutils literal notranslate"><span class="pre">b0.nextevent.t</span></code>, we update <code class="docutils literal notranslate"><span class="pre">b0.nextevent</span></code> to be the collision between <code class="docutils literal notranslate"><span class="pre">b0</span></code> and <code class="docutils literal notranslate"><span class="pre">bj</span></code>.  Similarly if that collision time is shorter than <code class="docutils literal notranslate"><span class="pre">bj.nextevent.t</span></code> we update <code class="docutils literal notranslate"><span class="pre">bj.nextevent</span></code>.</p>
<p>We then look at <code class="docutils literal notranslate"><span class="pre">b0.nextevent.t</span></code> and <code class="docutils literal notranslate"><span class="pre">bj.nextevent.t</span></code>.  If either is before <code class="docutils literal notranslate"><span class="pre">billiard.nextevent.t</span></code> then we update <code class="docutils literal notranslate"><span class="pre">billiard.nextevent</span></code>.</p>
<p>Finally, we need to loop through all of the walls, and if any of their collisions with <code class="docutils literal notranslate"><span class="pre">b0</span></code> are shorter than <code class="docutils literal notranslate"><span class="pre">b0.nextevent.t</span></code> we update <code class="docutils literal notranslate"><span class="pre">b0.nextevent</span></code>.  If that collision time is shorter than <code class="docutils literal notranslate"><span class="pre">billiard.nextevent.t</span></code> we also update <code class="docutils literal notranslate"><span class="pre">billiard.nextevent</span></code>.</p>
<p>After looping through all of the balls (and walls), we will have upddated all of the <code class="docutils literal notranslate"><span class="pre">nextevent</span></code> objects – but only required a <span class="math notranslate nohighlight">\(O(N)\)</span> time. For comparison, the previous algorithm required <span class="math notranslate nohighlight">\(O(N^2)\)</span> time.
Thus for 100 balls this will run 100 times faster.</p>
<p>Write this new version of <code class="docutils literal notranslate"><span class="pre">setevents!</span></code>, and test it.  Here is how I did my tests:  In one cell I ran:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rb2=randomgrid(2,2,0.01,1,1)
visualize(rb2)
</pre></div>
</div>
<p>then in the next cell I repeatedly ran:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>setevents!(rb2,rb2.nextevent)
update!(rb2,rb2.nextevent)
visualize(rb2)
</pre></div>
</div>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 13
</h2><p>Now write an updated version of <code class="docutils literal notranslate"><span class="pre">simulate</span></code> – which calls the new <code class="docutils literal notranslate"><span class="pre">setevents!</span></code>.  Test</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 14
</h2><p>Just like the Sinai Billiard, this system is chaotic. In fact, it is a specific type of chaotic system which is referred to as Ergodic.   If one runs the simulation for enough time, one expects to uniformly sample all possible configurations of the balls which are consistent with the initial conditions.</p>
<p>In practice this means the only constraint is that the total energy is conserved.  As we will discuss in lecture, this means that if we have a large number of balls, and all the balls start out with velocity 1, then at long times we expect the velocity distribution of each ball to be drawn randomly from a Maxwell-Boltzmann distribution,</p>
<div class="amsmath math notranslate nohighlight" id="equation-f86036b3-5289-4e65-acba-750817cbd93c">
<span class="eqno">()<a class="headerlink" href="#equation-f86036b3-5289-4e65-acba-750817cbd93c" title="Permalink to this equation">#</a></span>\[\begin{equation}
P(v)= 2 v \exp(-v^2).
\end{equation}\]</div>
<p>To test this out, what you want to do is run a simulation with ~100 Balls (so a 10x10 grid) for a large number of collisions (say 5000). The ball radius is not so critical here.  Something like <code class="docutils literal notranslate"><span class="pre">radius=0.01</span></code> works well if the box sides have length 1. Take the last state, and make a list of the speeds of all the particles.  Use the <code class="docutils literal notranslate"><span class="pre">histogram</span></code> function to plot them.  Given that there are only 100 speeds, the histogram will be pretty blocky.  Note, <code class="docutils literal notranslate"><span class="pre">histogram</span></code> takes an argument <code class="docutils literal notranslate"><span class="pre">normalize=true</span></code>, which will normalize it to make a probability distribution function.</p>
<p>Draw the theoretical curve on the histogram.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:red; color:white;" >
## Activity 13
</h2><p>To get better resolution on our histogram, we want to bin together data at different times.  We would naively expect that after ~<span class="math notranslate nohighlight">\(N\)</span> collisions we should get a statistically independent set of velocities.  Here is a function which makes a list of speeds from a frame of the simulation data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    speedlist(sim::Simulationdata,frame::Integer)</span>

<span class="s">Makes a list of the speeds of all of the particles in frame number </span>
<span class="s">`frame` of the simulation data.  You can also call it with a list of</span>
<span class="s">frames and it will concatentate those lists.</span>

<span class="s">For example, you can call with</span>

<span class="s">    speedlist(s,[1,3,5])</span>

<span class="s">and get the speeds in frames 1, 3, 5.  We can even use</span>

<span class="s">    speedlist(s,1::10::100)</span>

<span class="s">which will do every 10&#39;th frame between 1 and 100.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="n">speedlist</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulationdata</span><span class="p">,</span><span class="n">frame</span><span class="o">::</span><span class="kt">Integer</span><span class="p">)</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">sqrt</span><span class="o">.</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">statelist</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">vxvalues</span><span class="o">.^</span><span class="mi">2</span>
<span class="w">            </span><span class="o">+</span><span class="n">sim</span><span class="o">.</span><span class="n">statelist</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">vyvalues</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span>

<span class="n">speedlist</span><span class="p">(</span><span class="n">sim</span><span class="o">::</span><span class="kt">Simulationdata</span><span class="p">,</span><span class="n">frames</span><span class="p">)</span><span class="o">=</span>
<span class="w">    </span><span class="n">vcat</span><span class="p">([</span><span class="n">speedlist</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">frames</span><span class="p">]</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>speedlist (generic function with 2 methods)
</pre></div>
</div>
</div>
</div>
<p>Run your simulation for another 50,000 collisions, and make a Histogram that contains the speeds from every 100’th frame.  (Which will give you 50,000 speeds).  Again compare with the Maxwell-Boltzmann expectation.</p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:blue; color:white;" >
## Bonus 1
</h2><p>With some rather small changes, one can incorporate different masses into the simulation.  You could then have large heavy particles and small light particles scattering off one-another.  It could be fun to do that.  <strong>This is fully optional</strong></p>
<h2 style="border: 2px solid #000; border-radius: 10px; padding: 20px; background-color:blue; color:white;" >
## Bonus 2
</h2><p>It turns out that there are a number of further algorithmic improvements that we can make.  Follow
<a class="reference external" href="https://arxiv.org/pdf/2201.01100%5D">this link</a> for a practical review.  Another, slightly broader discussion can be found <a class="reference external" href="https://pubs.aip.org/aip/jcp/article/157/23/234111/2842446/Hard-disk-pressure-computations-a-historic">here</a>.</p>
<p>The next improvements take a bit of work – and you only should do them if it interests you.  <strong>This is fully optional</strong></p>
<p>The first trick is that we can do <em>asynchronous updates</em>.  Each ball can have its own clock.  In the <code class="docutils literal notranslate"><span class="pre">update!</span></code> step we only need to update the positions of the balls that were involved in the collision.  We then need to modify the <code class="docutils literal notranslate"><span class="pre">collision_time</span></code> method, so that it can act on balls whos positions are given at different time:  For example, suppose <code class="docutils literal notranslate"><span class="pre">ball1</span></code> is at position <code class="docutils literal notranslate"><span class="pre">x1</span></code> at time <code class="docutils literal notranslate"><span class="pre">t1</span></code>, and <code class="docutils literal notranslate"><span class="pre">ball2</span></code> is at position <code class="docutils literal notranslate"><span class="pre">x2</span></code> at time <code class="docutils literal notranslate"><span class="pre">t2</span></code>.  If these had vanishing radii, the collision time sattisfies</p>
<div class="amsmath math notranslate nohighlight" id="equation-73460866-3735-493c-986a-7a3056a16b0f">
<span class="eqno">()<a class="headerlink" href="#equation-73460866-3735-493c-986a-7a3056a16b0f" title="Permalink to this equation">#</a></span>\[\begin{equation}
\vec{x_1}+(t-t_1)\vec{v_1}=\vec{x_2}+(t-t_2)\vec{v_2}
\end{equation}\]</div>
<p>which is readily solved for <span class="math notranslate nohighlight">\(t\)</span>.  This is easily incorporated into our functions.</p>
<p>The second trick is to divide the <code class="docutils literal notranslate"><span class="pre">billiard</span></code> into spatial cells.  Each ball is placed in a cell.  Possible events include scattering with other particles in the same cell, or hitting the cell boundary – in which case the particle is moved to the neighboring cell.  Because we only need to worry about collisions in the same cell, this converts the problem of finding the next collision from <span class="math notranslate nohighlight">\(O(N)\)</span> to <span class="math notranslate nohighlight">\(O(1)\)</span>.</p>
<p>Using these two tricks we get a speedup by another factor of <span class="math notranslate nohighlight">\(N\)</span> – so roughly <span class="math notranslate nohighlight">\(100\)</span> for the cases we have been considering.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.10"
        },
        kernelOptions: {
            name: "julia-1.10",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.10'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Billiards.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Billiards</p>
      </div>
    </a>
    <a class="right-next"
       href="ktheory.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Kinetic Theory of Gases</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-in-packages-and-set-up-logger">Load in Packages, and set up logger</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goal">Goal</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Erich Mueller
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>